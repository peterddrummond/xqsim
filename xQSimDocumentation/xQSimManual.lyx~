#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrartcl
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 2
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
xQSim Manual: v2.0
\end_layout

\begin_layout Author
Peter D.
 Drummond, Alexander S.
 Dellios
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Large, network based experiments in quantum optics are becoming increasingly
 common, pushing the development of networks to ever large sizes.
 These optical linear networks have a variety of applications such as quantum
 computers implementing a type of random-number generation 
\begin_inset CommandInset citation
LatexCommand cite
key "Aaronson2011,AaronsonArkhipov2013LV,Aaronson:2014,Hamilton2017PhysRevLett.119.170501,quesada2018gaussian,kruse2019detailed"
literal "false"

\end_inset

 and large scale interferometers producing output measurements below the
 shot noise limit 
\begin_inset CommandInset citation
LatexCommand cite
key "Motes2015_PRL114,Su2017Multiphoton"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
Many implementations use nonclassical inputs 
\begin_inset CommandInset citation
LatexCommand cite
key "Reid1986violations"
literal "false"

\end_inset

 such as squeezed states or number states.
 These are not mathematically representable as a classical, positive, non-singul
ar Glauber-Sudarshan phase-space distribution 
\begin_inset CommandInset citation
LatexCommand cite
key "Glauber_1963_P-Rep,Sudarshan_1963_P-Rep"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
Recently, large networks employed as quantum computers have been used to
 claim quantum computational advantage 
\begin_inset CommandInset citation
LatexCommand cite
key "arute2019quantum,zhong2020quantum,Zhong2021Phase,madsenQuantumComputationalAdvantage2022"
literal "false"

\end_inset

.
 This leads to a theoretical challenge: how does one check hardware operation?
 Are the random numbers generated correctly? Do they follow the expected
 probability distribution?
\end_layout

\begin_layout Standard
Traditional number-state validation methods are only practical for small
 scale networks, since they use an exponentially large basis set.
 This rules out direct calculations, due to the finite size, computational
 time and precision of a digital computer.
 Although more feasible, even Monte-Carlo methods take an exponentially
 long time digitally 
\begin_inset CommandInset citation
LatexCommand cite
key "bulmerBoundaryQuantumAdvantage2022a"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Other methods utilize marginal probabilities of the expected distribution,
 which are calculable 
\begin_inset CommandInset citation
LatexCommand cite
key "villalonga2021efficient,ohSpoofingCrossEntropy2022a"
literal "false"

\end_inset

.
 Although scalable, such methods cannot verify higher-order correlations
 generated in the network.
 Therefore, these methods can only validate part of a larger picture.
 
\end_layout

\begin_layout Standard
For Gaussian boson sampling with linear networks, other methods using quantum
 phase-space exist.
 These do allow comparisons of theory and experiment for large, nonclassical
 networks, simulating all possible correlations generated by an experiment.
 A computational implementation is necessary, however.
 xQSim - meaning e
\series bold
x
\series default
tensible 
\series bold
Q
\series default
uantum 
\series bold
Sim
\series default
ulations using phase-space representations - is a software package that
 does this.
 
\end_layout

\begin_layout Standard
While xQSim is able to compare theoretical predictions with experimental
 data, it cannot generate a direct random output of photon counts.
 This is the task implemented by experiments 
\begin_inset CommandInset citation
LatexCommand cite
key "zhong2020quantum,Zhong2021Phase,madsenQuantumComputationalAdvantage2022"
literal "false"

\end_inset

 and some validation methods 
\begin_inset CommandInset citation
LatexCommand cite
key "villalonga2021efficient"
literal "false"

\end_inset

.
 However, there is extensive theory suggesting that such brute-force computation
s are #P hard 
\begin_inset CommandInset citation
LatexCommand cite
key "Aaronson2011,AaronsonArkhipov2013LV,Aaronson:2014,lund2014boson,Hamilton2017PhysRevLett.119.170501,quesada2018gaussian,kruse2019detailed"
literal "false"

\end_inset

, and therefore our code implements a completely different approach.
\end_layout

\begin_layout Standard
To do this, we employ three phase-space simulation methods: the positive
 P-distribution 
\begin_inset CommandInset citation
LatexCommand cite
key "Drummond_generalizedP1980"
literal "false"

\end_inset

 (
\begin_inset Formula $method=1$
\end_inset

), the Wigner distribution 
\begin_inset CommandInset citation
LatexCommand cite
key "Wigner_1932"
literal "false"

\end_inset

 (
\begin_inset Formula $method=2$
\end_inset

), provided it has a positive distribution for the corresponding input state,
 and the Husimi Q-function 
\begin_inset CommandInset citation
LatexCommand cite
key "Husimi1940"
literal "false"

\end_inset

 (
\begin_inset Formula $method=3$
\end_inset

).
 
\end_layout

\begin_layout Standard
The present code distribution can simulate multidimensional photon probabilities
, photon number correlations and quadrature moments for a variety of inputs,
 networks and output measurements.
 It uses sampling and binning to obtain computable results, giving error-bars
 comparable to those of the experimental measurements.
 In addition to simulating Gaussian quantum inputs, admixtures of thermal
 noise can be included to model phase decoherence in the input states.
 
\end_layout

\begin_layout Standard
Saturating or click detectors require the use of 
\begin_inset Formula $method=1$
\end_inset

.
 This is also preferred for intensity correlations, due to the exponentially
 lower sampling error obtained.
 Quadrature measurements are best simulated with 
\begin_inset Formula $method=2$
\end_inset

.
 However, intensity correlation and quadrature probabilities can be simulated
 using all methods.
\end_layout

\begin_layout Standard
The code also generates arbitrarily binned moments.
 These are vital for large-scale comparisons with data, due to the exponential
 sparsity of the full probability distributions.
 It can also extract experimental moments from available public datasets,
 which depends on the available data and the encoding employed.
\end_layout

\begin_layout Standard
The programs provided are written in Matlab, which is a proprietary language
 of The Mathworks Inc.
 It is fully compatible with Octave, which is a free public domain clone
 of Matlab.
 Parallel features are only available in Matlab currently, and require the
 parallel toolbox to give large speed improvements on multicore computers.
 
\end_layout

\begin_layout Standard
A GPU/Python version exists 
\begin_inset CommandInset citation
LatexCommand cite
key "Opanchuk2021"
literal "false"

\end_inset

, for GPU enabled supercomputers.
 While this does not implement all the features of the Matlab version, it
 is faster, with up to 
\begin_inset Formula $16,000$
\end_inset

 qubits demonstrated.
 For user's familiar with the original xQSim version 
\begin_inset CommandInset citation
LatexCommand cite
key "Drummond2022simulating"
literal "false"

\end_inset

, four new features have been introduced: 
\end_layout

\begin_layout Itemize
Random permutations: Users can now randomly permute output binary patterns,
 changing the order of the binning for multi-dimensional simulations.
 This allows an exponential number of possible experimental comparisons
 to occur, with each permutation simulating a different correlation.
\end_layout

\begin_layout Itemize
New data: Experimental data and extraction code corresponding to the larger
 experiment from Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Zhong2021Phase"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Z-score, or Z-statistic, tests: An additional statistical test which allows
 users to determine how randomly distributed each output pattern is.
\end_layout

\begin_layout Itemize
xGraph3 compatibility: This version is fully compatible with xGraph3, a
 companion batch graphics program that includes extensive graphical and
 statistical comparisons.
\end_layout

\begin_layout Standard
Sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Theoretical-background"
plural "false"
caps "false"
noprefix "false"

\end_inset

 through 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Numerical-methods"
plural "false"
caps "false"
noprefix "false"

\end_inset

 outline all the necessary background theory implemented in xQSim.
 Additional theoretical details can also be found in Refs.
 
\begin_inset CommandInset citation
LatexCommand cite
key "drummond2020initial,Dellios2021,Drummond2022simulating,dellios2022validation"
literal "false"

\end_inset

.
 A description of the main simulation code 
\shape italic
xQSim
\shape default
 is given in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:xQSim-operation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 whilst descriptions of observables, comparison functions used for testing
 and experimental data are presented in sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Observations-and-comparisons"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Experimental-data"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
Finally, numerous examples of various input states and output distributions
 are presented in section.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Examples"
plural "false"
caps "false"
noprefix "false"

\end_inset

, with a general reference to xQSim functions and parameters provided in
 section.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:xqSIM-reference"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Section
Theoretical background
\begin_inset CommandInset label
LatexCommand label
name "sec:Theoretical-background"

\end_inset


\end_layout

\begin_layout Standard
This section provides a comprehensive theoretical background to the general
 theory of linear networks, including input inputs to the network, detection
 mechanisms and observable correlations.
 
\end_layout

\begin_layout Subsection
Linear photonic networks
\begin_inset CommandInset label
LatexCommand label
name "sec:Linear-photonic-networks"

\end_inset


\end_layout

\begin_layout Standard
The numerical code solves for output observables obtained after a linear
 transformation of a multi-mode quantum input state 
\begin_inset Formula $\hat{\rho}^{(\text{in})}$
\end_inset

.
 The mode transformation is generated by a linear photonic network of generalize
d beam-splitters and phase delays.
 This acts as an 
\begin_inset Formula $M$
\end_inset

-mode interferometer such that output modes are linear combinations of each
 input mode.
 
\end_layout

\begin_layout Standard
Without losses, the network itself is defined by an 
\begin_inset Formula $M\times M$
\end_inset

 unitary matrix 
\begin_inset Formula $\boldsymbol{U}$
\end_inset

.
 Physically, this corresponds to the interference of input photons that
 generates large amounts of entanglement due to the exponential number of
 paths available to photons.
 
\end_layout

\begin_layout Standard
In the ideal, lossless case, one has:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{a}_{i}^{(\text{out})}=\sum_{j=1}^{M}U_{ij}\hat{a}_{j}^{(\text{in})},\label{eq:linear_combo}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{a}_{i}^{(\text{in})}$
\end_inset

 and 
\begin_inset Formula $\hat{a}_{j}^{(\text{out})}$
\end_inset

 are the input and output annihilation operators for modes 
\begin_inset Formula $i$
\end_inset

, 
\begin_inset Formula $j$
\end_inset

 respectively.
 
\end_layout

\begin_layout Standard
Practically, losses in the network are commonplace, thus causing the experimenta
l transmission matrix to be non-unitary.
 Therefore, lossy networks are denoted by the transmission matrix 
\begin_inset Formula $\boldsymbol{T}$
\end_inset

.
 Not every input channel needs to have an input.
 In these cases, 
\begin_inset Formula $N\subset M$
\end_inset

 represents the number of input modes, thus changing the unitary to an 
\begin_inset Formula $N\times M$
\end_inset

 transmission matrix.
 
\end_layout

\begin_layout Standard
These give a different transformation law, where:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{a}_{i}^{(\text{out})}=\sum_{j=1}^{N}T_{ij}\hat{a}_{j}^{(\text{in})}+\sum_{j=1}^{M}B_{ij}\hat{b}_{j}^{(\text{in})},\label{eq:linear_combo-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here, the 
\begin_inset Formula $M$
\end_inset

 operators 
\begin_inset Formula $\hat{b}_{i}^{(\text{in})}$
\end_inset

are noise operators.
 These are necessary to conserve the operator commutation relations.
 They comprise inputs from the reservoirs that cause losses, as well as
 the 
\begin_inset Formula $M-N$
\end_inset

 vacuum inputs at unused ports.
 They are independent commuting operators, whose reservoirs are all in a
 vacuum state.
\end_layout

\begin_layout Standard
Due to the need to conserve commutators, we know that for both inputs and
 outputs:
\begin_inset Formula 
\begin{align}
\left[\hat{a}_{i},\hat{a}_{j}\right] & =0\nonumber \\
\left[\hat{a}_{i},\hat{a}_{j}^{\dagger}\right] & =\delta_{ij}.\label{eq:bose_comm_rel}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Applying this to the outputs, considering a vacuum state input, and taking
 expectation values, gives
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align*}
\delta_{ij} & =\left\langle \left[\hat{a}_{i}^{(\text{out})},\hat{a}_{j}^{\dagger(\text{out})}\right]\right\rangle \\
 & =\left\langle \left[\sum_{k=1}^{M}\left(T_{ik}\hat{a}_{k}^{(\text{in})}+B_{ik}\hat{b}_{k}^{(\text{in})}\right),\sum_{\ell=1}^{M}\left(T_{j\ell}^{*}\hat{a}_{\ell}^{\dagger(\text{in})}+B_{j\ell}^{*}\hat{b}_{\ell}^{\dagger(\text{in})}\right)\right]\right\rangle \\
 & =\sum_{k=1}^{M}\left(T_{ik}T_{jk}^{*}+B_{ik}B_{jk}^{*}\right)=\left(\bm{T}\bm{T}^{\dagger}+\bm{B}\bm{B}^{\dagger}\right)_{ij}
\end{align*}

\end_inset


\end_layout

\end_inset


\begin_inset Formula 
\begin{align}
\delta_{ij} & =\left\langle \left[\hat{a}_{i}^{(\text{out})},\hat{a}_{j}^{\dagger(\text{out})}\right]\right\rangle \nonumber \\
 & =\sum_{k}\left(T_{ik}T_{jk}^{*}+B_{ik}B_{jk}^{*}\right).
\end{align}

\end_inset

Next, we can define a new 
\begin_inset Formula $M\times M$
\end_inset

 matrix
\begin_inset Formula 
\begin{equation}
\bm{D}=\bm{B}\bm{B}^{\dagger}=\bm{I}-\bm{T}\bm{T}^{\dagger}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This is hermitian, since 
\begin_inset Formula $\bm{D}^{\dagger}=\bm{D}$
\end_inset

, and so has a diagonal representation as 
\begin_inset Formula $D=\tilde{U}\lambda^{2}\tilde{U}^{\dagger}$
\end_inset

, for some unitary matrix 
\begin_inset Formula $\tilde{U}$
\end_inset

.
 We assume that the transmission matrix 
\begin_inset Formula $\bm{T}$
\end_inset

 is lossy, so that 
\begin_inset Formula $\bm{D}$
\end_inset

 is positive definite and 
\begin_inset Formula $\lambda$
\end_inset

 is real, representing absorption rather than gain.
\end_layout

\begin_layout Subsection
Quantum input states
\begin_inset CommandInset label
LatexCommand label
name "subsec:Quantum-input-states"

\end_inset


\end_layout

\begin_layout Standard
The input state is defined in a number of ways depending on the desired
 distribution one wishes to sample from.
 If each input mode is independent, 
\begin_inset Formula $\hat{\rho}^{(\text{in})}$
\end_inset

 is a product of input states.
 
\end_layout

\begin_layout Standard
To sample from the permanent, inputs are single photon Fock states such
 that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\rho}^{(\text{in})}=\prod_{j=1}^{M}\left|1\right\rangle _{j}\left\langle 1\right|_{j},
\end{equation}

\end_inset

where 
\begin_inset Formula $\left|1\right\rangle _{j}=a_{j}^{\dagger}\left|0\right\rangle $
\end_inset

.
 
\end_layout

\begin_layout Standard
To sample from the Hafnian or Torontonian, the input is a product of single-mode
 pure squeezed vacuum states 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\rho}^{(\text{in})}=\prod_{j=1}^{M}\left|r_{j}\right\rangle \left\langle r_{j}\right|,
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{r}=[r_{1},\dots,r_{M}]$
\end_inset

 is the squeezing vector and 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\left|r_{j}\right\rangle  & =\hat{S}(r_{j})\left|0\right\rangle \nonumber \\
 & =\exp\left(r_{j}\frac{(a_{j}^{\dagger})^{2}}{2}-r_{j}\frac{\hat{a}_{j}^{2}}{2}\right)\left|0\right\rangle ,\label{eq:squeezed_state_exp}
\end{align}

\end_inset

is the squeezed vacuum state where we have assumed the squeezed phase is
 zero.
\end_layout

\begin_layout Standard
Currently, xQSim can only generate input squeezed states and thermal states
 as outlined below.
 Other inputs are possible, since the positive P-representation and Q-representa
tion are complete, positive representations, and can be added through user
 customization.
\end_layout

\begin_layout Subsubsection
Pure squeezed states
\end_layout

\begin_layout Standard
For a single-mode, squeezed vacuum states are generated by applying the
 squeezing operator 
\begin_inset Formula $\hat{S}(r)$
\end_inset

 onto a vacuum state.
 As is clear from the operator definition Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:squeezed_state_exp"
plural "false"
caps "false"
noprefix "false"

\end_inset

), where we drop the 
\begin_inset Formula $j$
\end_inset

 subscript for the single-mode case, squeezed vacuum states always generate
 even numbers of photons.
 
\end_layout

\begin_layout Standard
The mean photon number 
\begin_inset Formula $\bar{n}=\left\langle \hat{a}^{\dagger}\hat{a}\right\rangle $
\end_inset

 and coherence 
\begin_inset Formula $m=\left\langle \left(\hat{a}\right)^{2}\right\rangle $
\end_inset

 can be derived using the relations 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\hat{S}^{\dagger}(r)\hat{a}\hat{S}(r) & =\hat{a}\cosh(r)-\hat{a}^{\dagger}\sinh(r)\nonumber \\
\hat{S}^{\dagger}(r)\hat{a}^{\dagger}\hat{S}(r) & =\hat{a}^{\dagger}\cosh(r)-\hat{a}\sinh(r),
\end{align}

\end_inset

where the mean photon number is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\bar{n} & =\left\langle \hat{a}^{\dagger}\hat{a}\right\rangle \nonumber \\
 & =\left\langle r\right|\hat{a}^{\dagger}\hat{a}\left|r\right\rangle \nonumber \\
 & =\left\langle 0\right|\hat{S}^{\dagger}(r)\hat{a}^{\dagger}\hat{a}\hat{S}(r)\left|0\right\rangle \nonumber \\
 & =\sinh^{2}(r),
\end{align}

\end_inset

whilst the coherence is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
m & =\left\langle \left(\hat{a}\right)^{2}\right\rangle \nonumber \\
 & =\left\langle r\right|\hat{a}\hat{a}\left|r\right\rangle \nonumber \\
 & =\left\langle 0\right|\hat{S}^{\dagger}(r)\hat{a}\hat{a}\hat{S}(r)\left|0\right\rangle \nonumber \\
 & =\sinh(r)\cosh(r).
\end{align}

\end_inset

 For pure squeezed states, the coherence and photon number are related via
 
\begin_inset Formula $m^{2}-\bar{n}=\bar{n}^{2}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The superposition of only even Fock states becomes clearer when expanding
 the squeezed state in terms of Fock states as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left|r\right\rangle =\frac{1}{\sqrt{\cosh(r)}}\sum_{n=0}^{\infty}\frac{\sqrt{(2n)!}}{2^{n}n!}\tanh^{n}(r)\left|2n\right\rangle ,\label{eq:Fock state_exp}
\end{equation}

\end_inset

where 
\begin_inset Formula $n=0,1,2,\dots$
\end_inset

 is the number of photons.
 From the above Fock state expansion the photon number distribution for
 the squeezed vacuum state is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
P_{2n} & =\frac{1}{\cosh(r)}\frac{(2n)!}{(n!)^{2n}2^{2n}}(\tanh(r))^{2n},\nonumber \\
P_{2n+1} & =0,
\end{align}

\end_inset

with variance 
\begin_inset Formula $\sigma_{n}^{2}=2\bar{n}(\bar{n}+1)=\bar{n}(1+\cosh(2r_{j}))$
\end_inset

.
 
\end_layout

\begin_layout Standard
Squeezed states are minimum uncertainty states and are therefore defined
 entirely by their quadrature variances.
 Using the quadrature operators 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\hat{x} & =\hat{a}+\hat{a}^{\dagger}\nonumber \\
\hat{y} & =-i\left(\hat{a}-\hat{a}^{\dagger}\right),
\end{align}

\end_inset

which obey the commutation relation 
\begin_inset Formula $\left[\hat{x}_{j},\hat{y}_{k}\right]=2i\delta_{jk}$
\end_inset

, the normally ordered 
\begin_inset Formula $x$
\end_inset

-quadrature variance is obtained as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\left\langle :(\Delta\hat{x})^{2}:\right\rangle  & =\left\langle \hat{x}^{2}\right\rangle \nonumber \\
 & =2(n+m)\nonumber \\
 & =e^{2r}-1,\label{eq:x-quad}
\end{align}

\end_inset

whilst the normally ordered 
\begin_inset Formula $y$
\end_inset

-quadrature variance is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\left\langle :(\Delta\hat{y})^{2}:\right\rangle  & =\left\langle \hat{y}^{2}\right\rangle \nonumber \\
 & =2(n-m)\nonumber \\
 & =e^{-2r}-1.\label{eq:y-quad}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
All the results derived here are also valid for multiple modes, denoted
 by the subscript 
\begin_inset Formula $j$
\end_inset

, given each mode is independent as is the case in optical networks.
 Currently, xQSim can simulate pure and thermalized squeezed states as well
 as classical thermal state inputs into the network.
 This is achieved using a model for thermal squeezed states which alters
 the multi-mode input coherence 
\begin_inset Formula $m(r_{j})$
\end_inset

 as 
\begin_inset Formula $\tilde{m}(r_{j})=(1-\epsilon)m(r_{j})$
\end_inset

 whilst keeping the input photon number 
\begin_inset Formula $n(r_{j})=\bar{n}_{j}$
\end_inset

 unchanged.
 This allows users to easily interpolate between thermal, 
\begin_inset Formula $\epsilon=1$
\end_inset

, and pure squeezed, 
\begin_inset Formula $\epsilon=0$
\end_inset

, states.
 
\end_layout

\begin_layout Subsubsection
Squeezed thermal states
\end_layout

\begin_layout Standard
Thermal states are classical states with fluctuations larger than the vacuum
 limit such that their quadrature variances are 
\begin_inset Formula $\left\langle :(\Delta\hat{x})^{2}:\right\rangle =\left\langle :(\Delta\hat{y})^{2}:\right\rangle $
\end_inset

.
 
\end_layout

\begin_layout Standard
In terms of Fock states, the thermal state density matrix is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\rho}=\frac{1}{1+\bar{n}}\sum_{n=0}^{\infty}\left(\frac{\bar{n}}{1+\bar{n}}\right)^{n}\left|n\right\rangle \left\langle n\right|,
\end{equation}

\end_inset

which gives the well known photon number distribution 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P\left(n\right)=\frac{\bar{n}^{n}}{\left(\bar{n}+1\right)^{n+1}}.\label{eq:thermal state dis}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Thermal states can be used to generate squeezed thermal states with initial
 occupation 
\begin_inset Formula $n_{th}$
\end_inset

, which gives 
\begin_inset CommandInset citation
LatexCommand cite
key "marian1992higher"
literal "false"

\end_inset

:
\begin_inset Formula 
\begin{align}
\bar{n}= & n_{th}+\left(2n_{th}+1\right)\sinh^{2}\left(r\right)\nonumber \\
\tilde{m}= & \left(2n_{th}+1\right)\sinh\left(r\right)\cosh\left(r\right).
\end{align}

\end_inset

In the thermalized case, the relationship between coherence and photon number
 is modified, since to eliminate 
\begin_inset Formula $r$
\end_inset

 one must use the relationship that
\begin_inset Formula 
\begin{align*}
\frac{\tilde{m}^{2}}{\left(2n_{th}+1\right)^{2}} & =\sinh^{2}\left(r\right)\left(1+\sinh^{2}\left(r\right)\right)\\
 & =\frac{\bar{n}-n_{th}}{\left(2n_{th}+1\right)}\left(1+\frac{\bar{n}-n_{th}}{\left(2n_{th}+1\right)}\right)
\end{align*}

\end_inset

Therefore:
\begin_inset Formula 
\begin{align}
\tilde{m}^{2} & =\left(\bar{n}-n_{th}\right)\left(1+\bar{n}+n_{th}\right)\nonumber \\
 & =\bar{n}+\bar{n}^{2}-\left(n_{th}^{2}+n_{th}\right).
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Squeezed thermal states are used as a test case, since one can define the
 saturating, or click, detectors in terms of the photon number and coherence
 as explained below.
 An example of such a test is also given in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Squeezed-thermalised-state-example"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Subsection
Photon counting
\end_layout

\begin_layout Standard
Photonic networks employed as quantum computers aim to sample from an output
 state whose distribution corresponds to the 
\begin_inset Formula $\#P$
\end_inset

-hard matrix permanent, Hafnian or Torontonian distributions.
 Which output probability is sampled depends on the input states to the
 network, with Fock states corresponding to the permanent and squeezed states
 corresponding to the Hafnian or Torontonian distributions, where the difference
 between these distributions comes from the detector used.
 
\end_layout

\begin_layout Standard
The sampled distribution not only depends on the input state but also the
 detector type.
 When photon-number resolving (PNR) detectors are used one samples either
 the permanent, given the input is a Fock state, or the Hafnian distribution
 for a squeezed state input.
 The Torontonian corresponds to the use of saturating, or click, detectors
 with squeezed state inputs.
 
\end_layout

\begin_layout Standard
Output samples from linear networks consist of photon count patterns.
 The 
\begin_inset Formula $j$
\end_inset

-th detector records 
\begin_inset Formula $c_{j}=0,1,2,\dots$
\end_inset

 photon counts, with a specific output pattern being denoted by the count
 vector 
\begin_inset Formula $\boldsymbol{c}$
\end_inset

.
 
\end_layout

\begin_layout Standard
From standard photon counting theory, the projection operator for observing
 
\begin_inset Formula $c_{j}=0,1,2,\dots$
\end_inset

 counts is denoted by 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{p}_{j}(c_{j})=\frac{1}{c_{j}!}:(\hat{n}'_{j})^{c_{j}}e^{-\hat{n}'_{j}}:,\label{eq:photon_counting_proj}
\end{equation}

\end_inset

where 
\begin_inset Formula $:\dots:$
\end_inset

 denotes normal ordering and 
\begin_inset Formula $\hat{n}'_{j}=a_{j}^{\dagger(\text{out})}a_{j}^{(\text{out})}$
\end_inset

 is the output photon number.
 
\end_layout

\begin_layout Standard
For PNR detectors, which can discriminate between photon numbers, each detector
 is defined by the above projector, with the projection operator for a specific
 output pattern given as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{P}(\boldsymbol{c})=\bigotimes_{j=i}^{M}\hat{p}_{j}(c_{j}).
\end{equation}

\end_inset

The expectation value of the PNR pattern projection operator corresponds
 to the Hafnian
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\text{Haf}=\left\langle \hat{P}(\boldsymbol{c})\right\rangle ,
\end{equation}

\end_inset

which is 
\begin_inset Formula $\#P$
\end_inset

-hard to compute at large 
\begin_inset Formula $M$
\end_inset

.
 
\end_layout

\begin_layout Standard
Click detectors saturate for more than one count at a detector.
 Therefore, outputs are binary with 
\begin_inset Formula $c_{j}=1$
\end_inset

 denoting a detection event, even if multiple photons hit the same detector,
 and 
\begin_inset Formula $c_{j}=0$
\end_inset

 is no detection event.
 From Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:photon_counting_proj"
plural "false"
caps "false"
noprefix "false"

\end_inset

), the click projection operator is obtained by summing over all 
\begin_inset Formula $c_{j}>0$
\end_inset

 counts such that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\hat{\pi}(1) & =:\sum_{c_{j}>0}\frac{(\hat{n}'_{j})^{c_{j}}}{c_{j}!}e^{-\hat{n}'_{j}}:\nonumber \\
 & =1-e^{-\hat{n}'_{j}},
\end{align}

\end_inset

which gives the standard saturating detector projection operator 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\pi}_{j}(c_{j})=:e^{-\hat{n}'_{j}}\left(e^{\hat{n}'_{j}}-1\right)^{c_{j}}:.\label{eq:click proj}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The projection operator for an pattern output is then similarly defined
 as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\Pi}(\boldsymbol{c})=\bigotimes_{j=i}^{M}\hat{\pi}_{j}(c_{j}),
\end{equation}

\end_inset

where the expectation value corresponds to the Torontonian distribution
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\text{Tor}=\left\langle \hat{\Pi}(\boldsymbol{c})\right\rangle .
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Exact outputs
\begin_inset CommandInset label
LatexCommand label
name "subsec:Exact-click"

\end_inset


\end_layout

\begin_layout Standard
To test photon count distributions, xQSim uses a modified version of the
 click probabilities which can be computed exactly in the limit of a unit
 transmission matrix.
 
\end_layout

\begin_layout Standard
Using the thermal state photon number distribution Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:thermal state dis"
plural "false"
caps "false"
noprefix "false"

\end_inset

), one obtains the click distributions:
\begin_inset Formula 
\begin{align}
\pi\left(0\right)=P\left(0\right) & =\frac{1}{\bar{n}+1}\nonumber \\
\pi\left(1\right)=1-\pi\left(0\right) & =\frac{\bar{n}}{\bar{n}+1}.
\end{align}

\end_inset

Substituting the thermal squeezed state modified photon number the probability
 of a vacuum state is 
\begin_inset CommandInset citation
LatexCommand cite
key "marian1992higher"
literal "false"

\end_inset

:
\begin_inset Formula 
\begin{align*}
\pi\left(0\right) & =\frac{1}{n_{th}+1}\left(1+\frac{2n_{th}+1}{\left(n_{th}+1\right)^{2}}\sinh^{2}\left(r\right)\right)^{-(1/2)}\\
 & =\left(\bar{n}-n_{th}+\left(n_{th}+1\right)^{2}\right)^{-(1/2)}\\
 & =\left(1+\bar{n}+n_{th}+n_{th}^{2}\right)^{-(1/2)}\\
 & =\left(\left(1+\bar{n}\right)^{2}-\tilde{m}^{2}\right)^{-(1/2)}.
\end{align*}

\end_inset

Hence, by using known results for a photon number distribution of a squeezed
 thermal state 
\begin_inset CommandInset citation
LatexCommand cite
key "marian1992higher"
literal "false"

\end_inset

, combined with the definitions of 
\begin_inset Formula $\bar{n}$
\end_inset

 and 
\begin_inset Formula $\tilde{m}$
\end_inset

, the probability of a vacuum state and a non-vacuum or click state are:
\begin_inset Formula 
\begin{align}
\left\langle \hat{\pi}\left(0\right)\right\rangle  & =\frac{1}{\sqrt{\left(1+\bar{n}\right)^{2}-\tilde{m}^{2}}}\nonumber \\
\left\langle \hat{\pi}\left(1\right)\right\rangle  & =1-\frac{1}{\sqrt{\left(1+\bar{n}\right)^{2}-\tilde{m}^{2}}}.
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Example applications of this result is presented in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Squeezed-thermalised-state-example"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Intensity correlations
\end_layout

\begin_layout Standard
xQSim generates comparisons of two types of correlations: Glauber intensity
 correlations and grouped correlations, also referred to as a grouped count
 probabilities (GCPs).
 
\end_layout

\begin_layout Standard
Intensity correlation simulations can only be performed on photon number
 operator observables.
 Therefore, although they are valid for determining photon number probabilities
 in click experiments, they correspond directly to PNR detector outputs.
 Meanwhile GCPs are only valid for click detectors.
 Although methods are available which convert PNR detectors to click detectors,
 direct binning methods for PNR outputs will be included in a sequential
 updates.
 
\end_layout

\begin_layout Standard
Glauber's 
\begin_inset Formula $n$
\end_inset

-th order intensity correlation is defined as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
G^{(n)}(c_{j})=\left\langle :(\hat{n}'_{j})^{c_{j}}\dots(\hat{n}'_{M})^{c_{M}}:\right\rangle ,
\end{equation}

\end_inset

where 
\begin_inset Formula $n=\sum c_{j}$
\end_inset

 is the correlation order.
 Multi-mode Glauber correlations determine the probability of detecting
 
\begin_inset Formula $n$
\end_inset

 photons at 
\begin_inset Formula $n$
\end_inset

 modes.
 
\end_layout

\begin_layout Standard
The normal ordering requirement causes all creation operators to the right
 and all annihilation operators to the left.
 For example, the second-order correlation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
G^{(2)}=\left\langle a_{1}^{\dagger(\text{out})}a_{2}^{\dagger(\text{out})}a_{2}^{(\text{out})}a_{1}^{(\text{out})}\right\rangle ,
\end{equation}

\end_inset

corresponds to detecting one photon at mode 
\begin_inset Formula $1$
\end_inset

 and one at mode 
\begin_inset Formula $2$
\end_inset

.
 
\end_layout

\begin_layout Standard
Upon reordering using the standard Bose commutation relations Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bose_comm_rel"
plural "false"
caps "false"
noprefix "false"

\end_inset

), one obtains 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
G^{(2)}=\left\langle a_{1}^{\dagger(\text{out})}a_{2}^{(\text{out})}\right\rangle \left\langle a_{2}^{\dagger(\text{out})}a_{1}^{(\text{out})}\right\rangle +\left\langle a_{1}^{\dagger(\text{out})}a_{1}^{(\text{out})}\right\rangle \left\langle a_{2}^{\dagger(\text{out})}a_{2}^{(\text{out})}\right\rangle .
\end{equation}

\end_inset

The first term describes non-local correlations which is the interference
 of photons between detectors, whilst the second term describes the photon
 intensity at a detector or local correlations.
 
\end_layout

\begin_layout Standard
If the mean number of photons is small, such that a detector will only ever
 observe one photon, the intensity correlation becomes a coincidence count
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P_{N}=\left\langle \prod_{j}\hat{n}'_{j}\right\rangle ,
\end{equation}

\end_inset

as we assume photons do not interfere at detectors, removing non-local correlati
ons.
 
\end_layout

\begin_layout Subsection
Grouped correlations
\end_layout

\begin_layout Standard
Grouped count probabilities (GCPs) are the main observable correlation implement
ed by xQSim and are only valid for click detectors.
 
\end_layout

\begin_layout Standard
GCPs are defined as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{G}_{\boldsymbol{S}}^{(n)}(\boldsymbol{m})=\left\langle \prod_{j=1}^{d}\left[\sum_{\sum c_{i}=m_{j}}\hat{\Pi}_{S_{j}}(\boldsymbol{c})\right]\right\rangle ,\label{eq:GCP}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{m}=(m_{1},\dots,m_{d})$
\end_inset

 are the observed grouped counts in 
\begin_inset Formula $d$
\end_inset

-dimensions and 
\begin_inset Formula $\boldsymbol{S}=(S_{1,}S_{2},\dots)$
\end_inset

 is a vector of disjoint subsets of 
\begin_inset Formula $\boldsymbol{M}=(M_{1},M_{2},\dots)$
\end_inset

 modes.
 
\end_layout

\begin_layout Standard
Each grouped count is obtained by summing over binary patterns 
\begin_inset Formula $m_{j}=\sum_{i}^{M}c_{i}$
\end_inset

.
 Therefore, grouped counts contain 
\begin_inset Formula $k$
\end_inset

 bins, with each bin corresponding to the total number of clicks in each
 pattern.
 In one-dimension, GCPs are the probability of observing 
\begin_inset Formula $m$
\end_inset

 counts in any pattern with 
\begin_inset Formula $n=M$
\end_inset

 and 
\begin_inset Formula $S=\{1,\dots,M\}$
\end_inset

.
 This observable is called total counts.
 
\end_layout

\begin_layout Standard
For larger dimensions, each grouped count sums over detector outputs for
 a subset of modes only such that 
\begin_inset Formula $m_{j}=\sum_{i}^{M/d}c_{i}$
\end_inset

.
 The modes in each subset are denoted in the vector 
\begin_inset Formula $\boldsymbol{S}$
\end_inset

.
 For example, in two-dimensions one has subsets 
\begin_inset Formula $\boldsymbol{S}=(S_{1},S_{2})$
\end_inset

 which contain modes 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
S_{1} & =\left\{ 1,\dots,\frac{M}{2}\right\} \nonumber \\
S_{2} & =\left\{ \frac{M+2}{2},\dots,M\right\} .
\end{align}

\end_inset

The output GCP is then a joint probability of observing 
\begin_inset Formula $m_{1}=\sum_{i=1}^{M/2}c_{i}$
\end_inset

 and 
\begin_inset Formula $m_{2}=\sum_{i=M/2+1}^{M}c_{i}$
\end_inset

 grouped counts with 
\begin_inset Formula $k=(M/2+1)^{2}$
\end_inset

 total bins.
 
\end_layout

\begin_layout Standard
The implied segregation of output modes in the two-dimensional example above
 is that 
\begin_inset Formula $S_{1}$
\end_inset

 will always contain the first 
\begin_inset Formula $M/d$
\end_inset

 modes, 
\begin_inset Formula $S_{2}$
\end_inset

 the next 
\begin_inset Formula $M/d+1\rightarrow2M/d$
\end_inset

 modes, and so on for larger dimensions.
 However, there is no practical restriction on the output modes each subset
 can contain.
 
\end_layout

\begin_layout Standard
Therefore, by randomly permuting each binary pattern we can change the output
 modes that are contained in each subset giving 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\binom{M}{M/d}}{d}=\frac{M!}{d(M/d)!(M-M/d)!},
\end{equation}

\end_inset

possible ways of generating 
\begin_inset Formula $m_{1},\dots,m_{d}$
\end_inset

 grouped counts without repeating a specific permutation.
 
\end_layout

\begin_layout Standard
For example, when 
\begin_inset Formula $M=4$
\end_inset

 and 
\begin_inset Formula $d=2$
\end_inset

, including the standard division, there are 
\begin_inset Formula $3$
\end_inset

 different orderings of outputs modes with subsets 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\boldsymbol{S} & =(S_{1},S_{2})=(\{1,2\},\{3,4\}),\nonumber \\
\boldsymbol{S} & =(S_{1},S_{2})=(\{1,3\},\{2,4\}),\nonumber \\
\boldsymbol{S} & =(S_{1},S_{2})=(\{1,4\},\{2,3\}).
\end{align}

\end_inset

Each permutation generates a different correlation, where we assume the
 commutation of GCP probabilities with subsets 
\begin_inset Formula $(\{1,3\},\{2,4\})=(\{2,4\},\{1,3\})$
\end_inset

.
 
\end_layout

\begin_layout Standard
This permutation only changes the multidimensional GCP simulations, as in
 the total count case all modes are contained in the same subset 
\begin_inset Formula $S=\{1,\dots,M\}$
\end_inset

.
 This is also the case when simulating marginal probabilities, which are
 obtained by setting 
\begin_inset Formula $n<M$
\end_inset

 such that 
\begin_inset Formula $M-n$
\end_inset

 inputs are ignored.
 The first-order marginal, 
\begin_inset Formula $n=1$
\end_inset

, is called the click correlation, 
\begin_inset Formula $\left\langle \hat{\pi}_{j}(1)\right\rangle $
\end_inset

, and determines the probability of observing a click at the 
\begin_inset Formula $j$
\end_inset

-th detector.
 
\end_layout

\begin_layout Section
Phase-space sampling
\end_layout

\begin_layout Standard
To simulate output probabilities, xQSim uses phase-space representations.
 As already explained, xQSim
\shape italic
 
\bar under
does not
\shape default
\bar default
 generate photon counts, which is the 
\begin_inset Formula $\#P$
\end_inset

-hard task implemented by experiments.
 Instead, phase-space representations allow users to compute 
\shape italic
distributions and moments
\shape default
 of the resulting output distributions of linear networks.
 
\end_layout

\begin_layout Standard
The outputs in phase-space are continuous real or complex variables whose
 stochastic moments are equal to moments of the experimental distributions,
 apart from sampling errors due to finite numbers of experimental and theoretica
l counts.
 This assumes that the parameters are precisely known, and do not have noise
 or fluctuations.
\end_layout

\begin_layout Subsection
Glauber P-representation
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $M$
\end_inset

-mode Glauber diagonal P-representation expands the density matrix as a
 sum of diagonal coherent state projectors 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\rho}=\int P(\boldsymbol{\alpha})\left|\boldsymbol{\alpha}\right\rangle \left\langle \boldsymbol{\alpha}\right|d^{2M}\boldsymbol{\alpha},
\end{equation}

\end_inset

where the distribution 
\begin_inset Formula $P(\boldsymbol{\alpha})$
\end_inset

 is a positive and non-singular distribution over multimode coherent state
 amplitudes 
\begin_inset Formula $\boldsymbol{\alpha}=[\alpha_{1},\dots,\alpha_{M}]$
\end_inset

 for classical states.
 
\end_layout

\begin_layout Standard
However, the diagonal P-representation famously breaks down for certain
 quantum states, generating non-positive and singular distributions.
 This is due to the lack of off-diagonal coherent state amplitudes needed
 to represent such nonclassical superpositions.
\end_layout

\begin_layout Subsection
Positive P-representation
\end_layout

\begin_layout Standard
Part of a family of generalized P-representations developed to extend Glauber's
 diagonal P-representation to quantum states 
\begin_inset CommandInset citation
LatexCommand cite
key "Drummond_generalizedP1980"
literal "false"

\end_inset

, the normally ordered positive-P representation always generates a non-singular
 and positive distribution for any quantum state.
 
\end_layout

\begin_layout Standard
The density matrix is defined as an expansion over a multidimensional subspace
 of the complex plane:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\rho}=\iint P(\boldsymbol{\alpha},\boldsymbol{\beta})\hat{\Lambda}(\boldsymbol{\alpha},\boldsymbol{\beta})\text{d}^{2M}\boldsymbol{\alpha}\text{d}^{2M}\boldsymbol{\beta},
\end{equation}

\end_inset

 where 
\begin_inset Formula $P(\boldsymbol{\alpha},\boldsymbol{\beta})$
\end_inset

 is the positive-P distribution over coherent state amplitudes 
\begin_inset Formula $\boldsymbol{\alpha},\boldsymbol{\beta}$
\end_inset

.
 The off-diagonal coherent state projector 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\Lambda}(\boldsymbol{\alpha},\boldsymbol{\beta})=\frac{\left|\boldsymbol{\alpha}\right\rangle \left\langle \boldsymbol{\beta}^{*}\right|}{\left\langle \boldsymbol{\beta}^{*}|\boldsymbol{\alpha}\right\rangle },
\end{equation}

\end_inset

doubles the classical phase-space dimension, allowing off-diagonal amplitudes
 
\begin_inset Formula $\boldsymbol{\beta}\neq\boldsymbol{\alpha}^{*}$
\end_inset

 to exist.
 
\end_layout

\begin_layout Standard
One can restrict the distribution to a classical phase-space with 
\begin_inset Formula $\boldsymbol{\beta}=\boldsymbol{\alpha}^{*}$
\end_inset

, in which case the diagonal P-representation is obtained as a special case
 of the positive P-representation via the substitution 
\begin_inset Formula $P(\boldsymbol{\alpha},\boldsymbol{\beta})=P(\boldsymbol{\alpha})\delta(\boldsymbol{\alpha}^{*}-\boldsymbol{\beta})$
\end_inset

.
 However, for squeezed states, this will lead to the singular behavior that
 is already known.
\end_layout

\begin_layout Standard
Moments of the positive-P distribution are equivalent to normally ordered
 operator moments 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\left\langle \hat{a}_{j_{1}}^{\dagger},\dots,\hat{a}_{j_{n}}\right\rangle  & =\left\langle \beta_{j_{1}},\dots,\alpha_{j_{n}}\right\rangle _{P}\nonumber \\
 & =\iint P(\boldsymbol{\alpha},\boldsymbol{\beta})[\beta_{j_{1}},\dots,\alpha_{j_{n}}]\text{d}^{2M}\boldsymbol{\alpha}\text{d}^{2M}\boldsymbol{\beta},
\end{align}

\end_inset

where 
\begin_inset Formula $\left\langle \dots\right\rangle $
\end_inset

 denotes a quantum expectation value and 
\begin_inset Formula $\left\langle \dots\right\rangle _{P}$
\end_inset

 is the positive-P probability average.
 
\end_layout

\begin_layout Standard
Although the diagonal P-representation is unsuitable to simulate squeezed
 or entangled states, other classical phase-space distributions exist with
 positive distributions for quantum states.
 These are the symmetrically orders Wigner representation and anti-normally
 ordered Q-function.
 
\end_layout

\begin_layout Subsection
Wigner representation
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $M$
\end_inset

-mode Wigner representation is defined as the Fourier transform of the symmetric
ally ordered characteristic function such that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
W(\boldsymbol{\alpha})=\frac{1}{\pi^{2M}}\int\text{d}^{2}\boldsymbol{z}\text{Tr}\left\{ \hat{\rho}e^{i\boldsymbol{z}(\hat{a}-\boldsymbol{\alpha})+i\boldsymbol{z}^{*}(\hat{a}^{\dagger}-\boldsymbol{\alpha}^{*})}\right\} ,
\end{equation}

\end_inset

where 
\begin_inset Formula $\text{Tr \{\ensuremath{\dots}\}}$
\end_inset

 is the trace and 
\begin_inset Formula $\boldsymbol{z}$
\end_inset

 is a complex vector.
 
\end_layout

\begin_layout Standard
Although the Wigner function always exists as a real-valued function on
 phase-space for the density operator, or any other hermitian operator,
 the resulting probability distribution need not be positive.
 This is why the Wigner distribution is referred to as a quasi-probability.
 However for thermal and squeezed states, the Wigner distribution is positive.
 
\end_layout

\begin_layout Standard
Despite the positive distribution, the Wigner function is only valid for
 symmetrically ordered operator products.
 Symmetric ordering, denoted 
\begin_inset Formula $\{\dots\}_{sym}$
\end_inset

, is the average over all possible combinations of creation and annihilation
 operators, for example
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\{\hat{a}^{\dagger}a\}_{sym} & =\frac{1}{2}(\hat{a}\hat{a}^{\dagger}+\hat{a}^{\dagger}\hat{a})\label{eq:sym_number_op}\\
\{\hat{a}^{\dagger}\hat{a}^{2}\}_{sym} & =\frac{1}{3}(\hat{a}^{2}\hat{a}^{\dagger}+\hat{a}\hat{a}^{\dagger}\hat{a}+\hat{a}^{\dagger}\hat{a}^{2}).
\end{align}

\end_inset


\end_layout

\begin_layout Standard
This ordering requirement makes applications to normally ordered detectors
 both cumbersome, as one must reorder all operators to normal order, and
 inaccurate, as seen from Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sym_number_op"
plural "false"
caps "false"
noprefix "false"

\end_inset

), where the expectation value of the symmetrically ordered number operator
 becomes 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\langle \{\hat{a}^{\dagger}a\}_{sym}\right\rangle =|\alpha|^{2}+\frac{1}{2}.
\end{equation}

\end_inset

Therefore, the Wigner function adds half a quantum of vacuum noise per mode
 causing a rapid increase sampling errors, making the Wigner function unsuitable
 for simulations of network output probabilities.
 
\end_layout

\begin_layout Standard
However, the Wigner function is ideal for simulating squeezed state quadrature
 operators, Eqs.(), as these are measured via homodyne detectors which are
 symmetrically ordered.
 
\end_layout

\begin_layout Subsection
Q-function
\end_layout

\begin_layout Standard
The standard form of the anti-normally ordered 
\begin_inset Formula $M$
\end_inset

-mode Q-function is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
Q(\boldsymbol{\alpha})=\frac{1}{\pi^{M}}\left\langle \boldsymbol{\alpha}|\hat{\rho}|\boldsymbol{\alpha}\right\rangle ,
\end{equation}

\end_inset

and, like the Wigner function, can be expressed as the Fourier transform
 of the anti-normally ordered characteristic function.
 
\end_layout

\begin_layout Standard
The Q-function distribution is always positive but is only defined for anti-norm
ally ordered operator products with moments being obtained as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\left\langle \hat{a}_{j_{1}},\dots,\hat{a}_{j_{n}}^{\dagger}\right\rangle  & =\left\langle \alpha_{j_{1}},\dots,\alpha_{j_{n}}^{*}\right\rangle _{Q}\nonumber \\
 & =\int Q(\boldsymbol{\alpha})[\alpha_{j_{1}},\dots,\alpha_{j_{n}}^{*}]\text{d}^{2M}\boldsymbol{\alpha},
\end{align}

\end_inset

where 
\begin_inset Formula $\left\langle \dots\right\rangle _{Q}$
\end_inset

 denotes a Q-distribution average.
 
\end_layout

\begin_layout Standard
However, like the Wigner function, operators must be reordered for applications
 to normally ordered detectors.
 Using the standard bosonic commutation relations, Eqs.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bose_comm_rel"
plural "false"
caps "false"
noprefix "false"

\end_inset

), the expectation value of the number operator is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\langle \{a\hat{a}^{\dagger}\}_{anti}\right\rangle =|\alpha|^{2}+1.
\end{equation}

\end_inset

The Q-function adds a quantum of vacuum noise per mode, generating the largest
 increase in sampling errors of any phase-space representation when used
 to simulate normally ordered detectors.
 This accumulation of vacuum noise for multimode networks rapidly causes
 the Q-function to become inaccurate for simulating linear networks.
 
\end_layout

\begin_layout Subsection
\begin_inset Formula $\sigma$
\end_inset

-ordering
\end_layout

\begin_layout Standard
The amount of vacuum noise added by each representation can be used to define
 the operator ordering parameter 
\begin_inset Formula $\sigma$
\end_inset

, where 
\begin_inset Formula $\sigma=0$
\end_inset

 corresponds to normal ordering, 
\begin_inset Formula $\sigma=1/2$
\end_inset

 symmetric ordering and 
\begin_inset Formula $\sigma=1$
\end_inset

 anti-normal ordering.
 
\end_layout

\begin_layout Standard
The ability to define a common ordering scheme arises from writing the Wigner
 and Q-function distributions as convolutions of the positive P-representation
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P_{\sigma}(\boldsymbol{\alpha})=\frac{1}{(\pi\sigma)^{M}}\int P(\boldsymbol{\alpha}_{0},\boldsymbol{\beta}_{0})e^{-(\boldsymbol{\alpha}-\boldsymbol{\alpha}_{0})(\boldsymbol{\alpha}^{*}-\boldsymbol{\beta}_{0})/\sigma}\text{d}^{2M}\boldsymbol{\alpha}\text{d}^{2M}\boldsymbol{\beta},
\end{equation}

\end_inset

where 
\begin_inset Formula $P_{\sigma}(\boldsymbol{\alpha})$
\end_inset

 is a 
\begin_inset Formula $\sigma$
\end_inset

-ordered representation, 
\begin_inset Formula $P(\boldsymbol{\alpha}_{0},\boldsymbol{\beta}_{0})$
\end_inset

 is the positive-P distribution and 
\begin_inset Formula $\boldsymbol{\alpha}_{0},\boldsymbol{\beta}_{0}$
\end_inset

 are used to denote the normal ordered nonclassical phase-space variables
 whilst 
\begin_inset Formula $\boldsymbol{\alpha},\boldsymbol{\alpha}^{*}$
\end_inset

 denotes a classical phase-space which is valid for 
\begin_inset Formula $\sigma=1/2,1$
\end_inset

.
 
\end_layout

\begin_layout Standard
Operator moments for any ordering can now be obtained via 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\left\langle \left\{ \hat{a}_{j_{1}}^{\dagger},\dots,\hat{a}_{j_{n}}\right\} _{\sigma}\right\rangle  & =\left\langle \alpha_{j_{1}}^{*},\dots,\alpha_{j_{n}}\right\rangle _{\sigma}\nonumber \\
 & =\int P_{\sigma}(\boldsymbol{\alpha})[\alpha_{j_{1}}^{*},\dots,\alpha_{j_{n}}]\text{d}^{2M}\boldsymbol{\alpha}.
\end{align}

\end_inset


\end_layout

\begin_layout Section
Numerical methods
\begin_inset CommandInset label
LatexCommand label
name "sec:Numerical-methods"

\end_inset


\end_layout

\begin_layout Standard
The section outlines the numerical methods and statistical tests implemented
 by xQSim to simulate linear network output distributions and perform comparison
s with either experimental data, or exact tests.
 
\end_layout

\begin_layout Subsection
Input-output samples
\end_layout

\begin_layout Standard
To simulate linear networks in phase-space, one must first generate initial
 stochastic samples.
 This is achieved using the 
\begin_inset Formula $\sigma$
\end_inset

-ordering scheme as stochastic samples for any Gaussian input state in any
 representation are generated following:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\alpha_{j} & =\frac{1}{2}\left(\Delta_{\sigma x_{j}}w_{j}+i\Delta_{\sigma y_{j}}w_{j+M}\right)\nonumber \\
\beta_{j} & =\frac{1}{2}\left(\Delta_{\sigma x_{j}}w_{j}-i\Delta_{\sigma y_{j}}w_{j+M}\right),
\end{align}

\end_inset

where 
\begin_inset Formula $\left\langle w_{j}w_{k}\right\rangle =\delta_{jk}$
\end_inset

 are real Gaussian noises and 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\Delta_{\sigma x_{j}}^{2} & =2(n_{j}+\sigma+\tilde{m}_{j})\nonumber \\
\Delta_{\sigma y_{j}}^{2} & =2(n_{j}+\sigma-\tilde{m}_{j}),\label{eq:quad_var_altered}
\end{align}

\end_inset

are thermal squeezed state quadrature variances which are altered from the
 pure squeezed state definitions Eqs.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:x-quad"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:y-quad"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 
\end_layout

\begin_layout Standard
For normally ordering, the input amplitudes 
\begin_inset Formula $\boldsymbol{\alpha},\boldsymbol{\beta}$
\end_inset

 are converted to outputs as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\boldsymbol{\alpha}' & =\boldsymbol{T\alpha}\nonumber \\
\boldsymbol{\boldsymbol{\beta}}' & =\boldsymbol{T}^{*}\boldsymbol{\beta},
\end{align}

\end_inset

which follows from Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:linear_combo"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 However for non-normally ordered methods, additional vacuum noise arising
 from the reservoir modes must be included.
 
\end_layout

\begin_layout Standard
This is achieved using a hermitian decoherence matrix 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{D}=\boldsymbol{I}-\boldsymbol{T}^{\dagger}\boldsymbol{T},
\end{equation}

\end_inset

with decomposition 
\begin_inset Formula $\boldsymbol{D}=\boldsymbol{U}\boldsymbol{\lambda}^{2}\boldsymbol{U}^{\dagger}$
\end_inset

 where 
\begin_inset Formula $\boldsymbol{B}=\boldsymbol{U}\boldsymbol{\lambda}\boldsymbol{U}^{\dagger}$
\end_inset

 is the matrix square root and 
\begin_inset Formula $\boldsymbol{\lambda}$
\end_inset

 is a diagonal, positive matrix.
 The output amplitudes when 
\begin_inset Formula $\sigma>0$
\end_inset

 are then obtained as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\alpha}'=\boldsymbol{T\alpha}+\sqrt{\frac{\sigma}{2}}\boldsymbol{B}(\boldsymbol{u}+i\boldsymbol{v}),
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\beta}'=\boldsymbol{\alpha}^{\prime*}$
\end_inset

 as we are in a classical phase-space.
 
\end_layout

\begin_layout Subsection
Grouped correlations computation
\end_layout

\begin_layout Standard
GCPs are readily simulated in phase-space using the positive-P representation
 by replacing the normally ordered projection operator Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:click proj"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with the positive-P observable 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\pi_{i}(c_{i})=:e^{-n'_{i}}\left(e^{n'_{i}}-1\right)^{c_{i}},
\end{equation}

\end_inset

where 
\begin_inset Formula $n'_{i}=\alpha'_{i}\beta'_{i}$
\end_inset

 is the output photon number.
 
\end_layout

\begin_layout Standard
The summation over exponentially many patterns implemented by GCPs (see
 Eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GCP"
plural "false"
caps "false"
noprefix "false"

\end_inset

) is simulated using a multidimensional inverse discrete Fourier transform
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\tilde{\mathcal{G}}_{\boldsymbol{S}}^{(n)}(\boldsymbol{k}) & =\left\langle \prod_{j=1}^{d}\bigotimes_{i\in S_{j}}\left(\pi_{i}(0)+\pi_{i}(1)e^{-ik_{j}\theta_{j}}\right)\right\rangle _{P},\nonumber \\
\mathcal{G}_{\boldsymbol{S}}^{(n)}(\boldsymbol{m}) & =\frac{1}{\prod_{j}(M_{j}+1)}\sum_{\boldsymbol{k}}\tilde{\mathcal{G}}_{\boldsymbol{S}}^{(n)}(\boldsymbol{k})e^{i\sum k_{j}\theta_{j}m_{j}},
\end{align}

\end_inset

where 
\begin_inset Formula $\theta_{j}=2\pi/(M_{j}+1)$
\end_inset

 and 
\begin_inset Formula $k_{j}=0,\dots,M_{j}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The Fourier transform removes all patterns which don't contain 
\begin_inset Formula $\boldsymbol{m}$
\end_inset

 counts, in doing this the Fourier transform simulates all possible correlations
 generated in a network.
 This reduces an otherwise computationally complex task into a highly efficient
 and scalable one, allowing comparisons to be performed on experimental
 correlations of any order.
 
\end_layout

\begin_layout Subsection
Statistical tests 
\end_layout

\begin_layout Standard
The data generated and compared with experiment is in the form of probabilities
 of clicks or binned click patterns.
 xQSim implements two statistical tests: chi-square and 
\begin_inset Formula $Z$
\end_inset

-statistic tests.
 
\end_layout

\begin_layout Subsubsection
Chi-square tests
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $n$
\end_inset

 observations in a random sample from a population are classified into classes
 with observed numbers 
\begin_inset Formula $x_{i}$
\end_inset

 (for 
\begin_inset Formula $i=1,2,…,k$
\end_inset

), and a null hypothesis gives the probability 
\begin_inset Formula $p_{i}$
\end_inset

 that an observation falls into the 
\begin_inset Formula $i$
\end_inset

-th class, then the expected numbers are 
\begin_inset Formula $m_{i}=np_{i}$
\end_inset

 .
\end_layout

\begin_layout Standard
The limiting distribution of the quantity given below is the 
\begin_inset Formula $\chi^{2}$
\end_inset

 distribution:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\chi^{2} & =\sum_{i=1}^{k}\frac{(x_{i}-m_{i})^{2}}{m_{i}}\\
 & =\sum_{i=1}^{k}\frac{(x_{i}/n-p_{i})^{2}}{p_{i}/n}.
\end{align*}

\end_inset

 For our purposes, define an experimental probability estimate as 
\begin_inset Formula $p_{i}^{e}=x_{i}/n$
\end_inset

, then
\begin_inset Formula 
\begin{align*}
\chi^{2} & =\sum_{i=1}^{k}\frac{(p_{i}^{e}-p_{i})^{2}}{\sigma_{i}^{2}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Here, 
\begin_inset Formula $\sigma_{i}^{2}=p_{i}/n$
\end_inset

, is the estimated experimental variance.
 This is only valid for click detectors, or PNR detectors when photon flux
 is small, as binary outputs can be modeled as Poissonian.
 For larger photon numbers this is not the case as multiple photons can
 be detected simultaneously.
 
\end_layout

\begin_layout Standard
Typically, counts less that 
\begin_inset Formula $x_{i}^{min}\sim10$
\end_inset

 are ignored, as the distribution is no longer Gaussian for small counts.
 The program produces 
\begin_inset Formula $\chi^{2}$
\end_inset

 tests that include an estimate of simulation errors:
\begin_inset Formula 
\[
\sigma_{i}^{2}=p_{i}/n+\sigma_{i}^{s2}
\]

\end_inset


\end_layout

\begin_layout Standard
Note that this can also be used to compare simulations with other analytic
 comparison theories, not just with experiment.
\end_layout

\begin_layout Subsubsection
Z-statistic tests
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $Z$
\end_inset

-statistic, or 
\begin_inset Formula $Z$
\end_inset

-score, test determines how many standard deviations a test statistic, 
\begin_inset Formula $X$
\end_inset

, is from its expected, normally distributed mean and is defined as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Z=\frac{X-\mu}{\sigma},
\]

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\sigma$
\end_inset

 are the mean and standard deviation of a normal distribution, respectively.
 
\end_layout

\begin_layout Standard
In the limit 
\begin_inset Formula $k\rightarrow\infty$
\end_inset

, the chi-square distribution of the test statistic approaches a normal
 distribution via the central limit theorem.
 Typically this convergence is slow, however using the Wilson-Hilferty (WH)
 transformation, an accurate convergence can be achieved when 
\begin_inset Formula $k\geq10$
\end_inset

.
 
\end_layout

\begin_layout Standard
Using the WH transformed chi-square statistic 
\begin_inset Formula $\left(\chi^{2}/k\right)^{1/3}$
\end_inset

, the 
\begin_inset Formula $Z$
\end_inset

-statistic of the chi-square distribution is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Z=\frac{\left(\chi^{2}/k\right)^{1/3}-(1-2/(9k))}{\sqrt{2/(9k)}},
\]

\end_inset

for comparisons with 
\begin_inset Formula $k\geq10$
\end_inset

 distinct classes.
 
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $Z$
\end_inset

-statistic is used to determine the randomness of output patterns, as large
 
\begin_inset Formula $Z$
\end_inset

 values could indicate experimental output patterns are not occurring randomly.
 A threshold of 
\begin_inset Formula $Z>6$
\end_inset

 is used to define outputs with extremely small probabilities of occurring.
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $Z$
\end_inset

-statistic becomes particularly powerful when used in conjunction with random
 permutations of output patterns, as repeatedly observing large 
\begin_inset Formula $Z$
\end_inset

 values indicates outputs with very small probabilities are being continuously
 observed.
 This could indicate systematic errors in an experimental network are causing
 non-random behavior, such as more 
\begin_inset Formula $0's$
\end_inset

 than 
\begin_inset Formula $1's$
\end_inset

 in binary patterns, to occur.
 
\end_layout

\begin_layout Section
xQSim operation
\begin_inset CommandInset label
LatexCommand label
name "sec:xQSim-operation"

\end_inset


\end_layout

\begin_layout Standard
The initial xQSim software distributions consists of Matlab functions, including
 
\emph on
xQSim
\emph default
 itself, together with functions called by 
\emph on
xQSim
\emph default
.
 There are also test scripts with inputs that can be modified.
 The functions used can be replaced as required for different applications.
 The input is a sequence of parameter structures in a cell array.
 The output data is a nested cell array giving first the sequence index,
 then one graph index for each average correlation calculated.
\end_layout

\begin_layout Standard
The output data is compatible with the 
\emph on
xGraph
\emph default
 multidimensional batch graphics program, documented separately.
 Other graphics codes can be used, too, if compatible with the data files.
 An example and description of the basic functions available is given below.
\end_layout

\begin_layout Subsection
xQSim example
\end_layout

\begin_layout Standard
xQSim is the quantum simulation code.
 To run this, an input m-file is needed to define the simulation parameters
 and run the code.
 A simple example is given below.
 This makes use of xGraph, an accompanying batch graphics program, but use
 of xGraph is optional.
 More examples are given in section.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Examples"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the xQSimExamples folder.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

p.matrix     = @Unitary;                %matrix type
\end_layout

\begin_layout Plain Layout

p.M          = 40;                      %matrix size m
\end_layout

\begin_layout Plain Layout

p.N          = 20;                      %input size n
\end_layout

\begin_layout Plain Layout

p.ensembles  = [1000,10,12];            %repeats for errors
\end_layout

\begin_layout Plain Layout

p.r          = 1;                       %squeezing parameter(s)
\end_layout

\begin_layout Plain Layout

p.observe    = {@n,@k};                 %correlation functions
\end_layout

\begin_layout Plain Layout

p.glabels    = {{'Mode m'},{'Mode m'}}; %axis label
\end_layout

\begin_layout Plain Layout

p.olabels    = {'<n>','<c>'};           %Numbers and clicks
\end_layout

\begin_layout Plain Layout

[e1,d,p]     = xQSim(p);                %simulation function
\end_layout

\begin_layout Plain Layout

xGraph(d,p);                            %graphics function
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Subsection
xQSim parameters
\end_layout

\begin_layout Standard

\series bold
The input is a cell array of parameter structures p.

\series default
 The code generates simulation data and sampling errors in an output cell
 data array 
\begin_inset Formula $d,$
\end_inset

 including comparative experimental or analytic data if required.
 An input cell array can be replaced by a single parameter structure if
 there is only one simulation in a sequence.
 Otherwise, the cell array defines a sequence of network transformations.
 
\end_layout

\begin_layout Standard
In general, simulations can treat an arbitrary sequence of networks and
 parameters.
 Some inputs are optional, and have specified defaults.
 These allow the input parameter list to be shortened.
 Full input parameter lists are in Sec (
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:xqSIM-reference"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 
\end_layout

\begin_layout Standard
The most used parameter inputs are:
\end_layout

\begin_layout Standard
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="16" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
deco
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
string
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
''
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Decoherence factors used for optimization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CO
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
None
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Correlation order
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
compare
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function handles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Optional comparison functions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ensembles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[1,1,1]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Size of vector, serial, parallel ensemble
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $eps$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An n-dimensional decoherence factor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
M
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total number of modes
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
matrix
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
matrix function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Identity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An 
\begin_inset Formula $M\times M$
\end_inset

 transfer matrix function
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
method
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Phase-space method: 
\begin_inset Formula $m=1,2,3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of excited input modes
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
character
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
''
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Name of simulation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
O
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vector of various correlation orders
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
observe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function handles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\{@(a,p)\,a\}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable functions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
permute
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[1,2,3,\dots,M]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random permutation of outputs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector or function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An n-dimensional squeezing vector
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An n-dimensional transmission factor
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Itemize
Note that vectors 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $eps$
\end_inset

, 
\begin_inset Formula $t$
\end_inset

 are 
\begin_inset Formula $N$
\end_inset

-dimensional.
 They are expanded to 
\begin_inset Formula $N$
\end_inset

 dimensions by repeating the last element, if they are less than 
\begin_inset Formula $N$
\end_inset

-dimensional.
 
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $ensembles(1)>1$
\end_inset

, all calculations are repeated in parallel and averaged using low-level,
 single core vector methods.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $ensembles(2)>1$
\end_inset

, calculations are repeated sequentially, in a loop, in order to estimate
 sampling errors.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $ensembles(3)>1$
\end_inset

, calculations are repeated using multi-core parallel loops.
 This is also used to estimate sampling errors.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $method>1$
\end_inset

, an alternative phase-space method is used: Wigner or Q.
 The default is the +P method.
 
\end_layout

\begin_layout Itemize
The squeezing vector 
\series bold

\begin_inset Formula $\bm{r}$
\end_inset


\series default
 and transfer matrix 
\begin_inset Formula $matrix$
\end_inset

 can be input as numbers or as a function handle.
 The transmission factor 
\begin_inset Formula $t$
\end_inset

 is an additional prefactor applied to inputs prior to the measured transmission
 
\begin_inset Formula $matrix$
\end_inset

 to allow additional fine-tuning.
\end_layout

\begin_layout Standard
Other notation used in the input structure is given in the associated preprint.
 One dataset is generated per observe function, but this can produce more
 than one plot, depending on the graphics options specified.
\end_layout

\begin_layout Subsection
Simulation notes
\end_layout

\begin_layout Subsubsection
General
\end_layout

\begin_layout Itemize
Starting from a vacuum state, 
\begin_inset Formula $\bm{a}^{(0)}$
\end_inset

, xQSim iteratively combines the 
\begin_inset Formula $n$
\end_inset

-th output 
\begin_inset Formula $\bm{a}^{(n)}$
\end_inset

 with a locally generated Gaussian, or another state in general.
 The quantum state is transformed through a network to generate 
\begin_inset Formula $\bm{a}^{(n+1)}$
\end_inset

 and detected.
 
\end_layout

\begin_layout Itemize
Each network is repeated 
\begin_inset Formula $cyc$
\end_inset

 times, with a default of 
\begin_inset Formula $cyc=1$
\end_inset

.
 If 
\begin_inset Formula $cyc>1$
\end_inset

, output data is indexed by cycle, and graphs vs cycle number are made.
 If 
\begin_inset Formula $cyc>1$
\end_inset

 and 
\begin_inset Formula $re>0$
\end_inset

, the field is recycled with recycling amplitude 
\begin_inset Formula $re$
\end_inset

.
 
\end_layout

\begin_layout Itemize
The 
\begin_inset Formula $gen$
\end_inset

 code generates the input, checks if random permutations are present and
 simulates the network.
\end_layout

\begin_layout Subsubsection
Optimizing decoherence & transmission
\end_layout

\begin_layout Standard
When using xQSim to compare theoretical and experimental quantum networks,
 it is recommended that the first simulation use 
\begin_inset Formula $eps=0$
\end_inset

 and 
\begin_inset Formula $t=1$
\end_inset

.
 This corresponds to pure squeezed state inputs as 
\begin_inset Formula $eps=\epsilon$
\end_inset

 (see subsection.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Quantum-input-states"
plural "false"
caps "false"
noprefix "false"

\end_inset

) whilst 
\begin_inset Formula $t$
\end_inset

 corresponds to measurement errors in the transmission matrix.
 
\end_layout

\begin_layout Standard
Once completed, users may wish to simulate decoherence effects.
 Although exact values of 
\begin_inset Formula $eps$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 are up to users discretion, it is recommended to use Matlab's 
\shape italic
fminsearch
\shape default
 function to find optimal fitting values.
 These correspond to the lowest obtainable 
\begin_inset Formula $\chi^{2}$
\end_inset

 output.
 An example of how to implement 
\shape italic
fminsearch
\shape default
 in xQSim is given below for the script 
\shape italic
xQSim_165W_experiment.m
\shape default
 contained in the folder 
\shape italic
xQSimExamples
\shape default
.
 
\end_layout

\begin_layout Standard
To start 
\shape italic
fminsearch
\shape default
 the following prompt is inserted into the Command Window: 
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

%Inital conditions:
\end_layout

\begin_layout Plain Layout

%x0(1) = t, x0(2) = eps
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

x0 = [1,0]
\end_layout

\begin_layout Plain Layout

x = fminsearch(@xQSim_165W_experiment, x0)%Call fminsearch
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
This will run xQSim multiple times for different parameters of 
\begin_inset Formula $eps$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 until it reaches a minimum at which point it will output the optimal values
 of 
\begin_inset Formula $eps$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

.
\end_layout

\begin_layout Standard
Some general considerations when using 
\shape italic
fminsearch
\shape default
 is that it will likely take multiple hours to complete, assuming the user
 has access to Matlab's parallel computing toolbox.
 Without the parallel toolbox computation time will increase significantly.
 If this is the case, a manual optimizing route may be more efficient.
 
\end_layout

\begin_layout Standard
To reduce computation time, 
\shape italic
fminsearch
\shape default
 can be stopped before it has found the absolute minimum.
 This is due to two reasons:
\end_layout

\begin_layout Enumerate
Since xQSim simulates stochastic samples, output probabilities will vary
 slightly between runs causing 
\shape italic
fminsearch
\shape default
 to run longer than may be necessary.
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\chi^{2}$
\end_inset

 output differences between simulation runs becomes negligible once 
\begin_inset Formula $eps$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 are accurate to 
\begin_inset Formula $\approx4/5$
\end_inset

 decimal places.
 Since 
\shape italic
fminsearch
\shape default
 will continue repeating simulations until a minimum is found, the increase
 in computation for greater decimal accuracy may outweigh the negligible
 improvement in 
\begin_inset Formula $\chi^{2}$
\end_inset

 results.
\end_layout

\begin_layout Standard
If the user wishes to have the option of stopping 
\shape italic
fminsearch
\shape default
 early, it is recommended to use the parameter 
\shape italic
p.deco
\shape default
.
 
\shape italic
fminsearch
\shape default
 doesn't output the values of 
\begin_inset Formula $eps$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 it uses in each simulation run, only outputting them once it's fully completed.
 Therefore, 
\shape italic
p.deco
\shape default
 prints the values of 
\begin_inset Formula $eps$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 before each simulation run, allowing the user to know what decoherence
 factors the most recent simulation run has used.
 
\end_layout

\begin_layout Standard

\series bold
Caution
\series default
 - When running 
\shape italic
fminsearch
\shape default
 be sure to either comment out or remove the graphics program 
\shape italic
xGraph
\shape default
 from the script as once 
\shape italic
fminsearch
\shape default
 is complete, Matlab will generate plots for every simulation run.
 These comparison plots are not necessary when optimizing decoherence and
 transmission and may cause Matlab to crash.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

function e = xQSim_165W_experiment(x)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

p.name = '144-mode: Waist=65um, power=1.65W';
\end_layout

\begin_layout Plain Layout

p.matrix    = @expmatrix;
\end_layout

\begin_layout Plain Layout

p.M         = 144;
\end_layout

\begin_layout Plain Layout

p.N         = 50;
\end_layout

\begin_layout Plain Layout

p.r         = @expsqueeze;
\end_layout

\begin_layout Plain Layout

p.ensembles = [5000,20,12];
\end_layout

\begin_layout Plain Layout

p.t 		= x(1);
\end_layout

\begin_layout Plain Layout

p.eps 	  = x(2);
\end_layout

\begin_layout Plain Layout

p.deco 	 = fprintf('
\backslash
n t =%d, epsilon=%d
\backslash
n',p.t,p.eps);
\end_layout

\begin_layout Plain Layout

p.counts    = 40183178;
\end_layout

\begin_layout Plain Layout

p.mincount  = 10;
\end_layout

\begin_layout Plain Layout

p.cutoff    = 1e-7;
\end_layout

\begin_layout Plain Layout

p.observe   = {@k,@k1};
\end_layout

\begin_layout Plain Layout

p.compare   = {@expk,@expk1};
\end_layout

\begin_layout Plain Layout

p.logs{2}   = [0,1];
\end_layout

\begin_layout Plain Layout

p.diffplot  = {2,2};
\end_layout

\begin_layout Plain Layout

p.glabels   = {{'j'},{'m'}};
\end_layout

\begin_layout Plain Layout

p.olabels   = {'<
\backslash
pi_j(1)>','G^{(M)}(m)'};
\end_layout

\begin_layout Plain Layout

p.xk{2}     = {0:p.M};
\end_layout

\begin_layout Plain Layout

[e,d,cp]    = xQSim(p);
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Subsubsection
Data extraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Data-extraction"

\end_inset


\end_layout

\begin_layout Standard
Data from both 
\begin_inset Formula $100$
\end_inset

-mode and 
\begin_inset Formula $144$
\end_inset

-mode experiments of Zhong et al 
\begin_inset CommandInset citation
LatexCommand cite
key "zhong2020quantum,Zhong2021Phase"
literal "false"

\end_inset

 have been extracted and are contained within the folder 
\shape italic
xQSimGBSE
\shape default
\emph on
xperiments
\emph default
.
 Due to their size, raw data files are not provided but can be obtained
 from 
\begin_inset CommandInset citation
LatexCommand cite
key "Raw100,Raw144"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
If the user is required to extract additional observable data, xQSim contains
 three data extraction algorithms: 
\end_layout

\begin_layout Itemize

\shape italic
qcounts
\shape default
: Extracts data from binary files with big endian encoding.
 Corresponds to experiment 
\begin_inset CommandInset citation
LatexCommand cite
key "zhong2020quantum"
literal "false"

\end_inset

.
 Algorithm is run separately from the input m-file simulation script and
 is only valid when 
\begin_inset Formula $M=100$
\end_inset

.
 
\end_layout

\begin_layout Itemize

\shape italic
qcountsbe
\shape default
: Extracts data from the same binary encoding as 
\shape italic
qcounts
\shape default
 but is integrated into the input m-file and is valid for any mode number.
 
\end_layout

\begin_layout Itemize

\shape italic
qcountsle
\shape default
: Extracts data from binary files with little endian encoding.
 Corresponds to experiment 
\begin_inset CommandInset citation
LatexCommand cite
key "Zhong2021Phase"
literal "false"

\end_inset

.
 Like 
\shape italic
qcountsbe
\shape default
, 
\shape italic
qcountsle
\shape default
 is integrated into the input m-file and is valid for any mode number.
 
\end_layout

\begin_layout Standard
An example implementation of 
\shape italic
qcountsle
\shape default
 is supplied below.
 To allow phase-space simulations to be performed immediately after extraction,
 the experimental counts integer 
\shape italic
Count
\shape default
 is output.
 When using 
\shape italic
qcountsbe
\shape default
 or 
\shape italic
qcountsle
\shape default
, the integer variable 
\shape italic
bits
\shape default
 is required to input the bit-type of the encoded data file.
 Although 
\shape italic
qcountsbe
\shape default
 and 
\shape italic
qcountsle
\shape default
 have been generalized, this is limited to data from experiments 
\begin_inset CommandInset citation
LatexCommand cite
key "zhong2020quantum,Zhong2021Phase"
literal "false"

\end_inset

 since every experiment may encode data differently.
 
\end_layout

\begin_layout Standard
The only time user's may wish to extract additional data is to perform random
 permutation tests, which require permutations to be applied before binning.
 In this case, one can use 
\shape italic
qcounts_permute
\shape default
 and 
\shape italic
qcountsle_permute
\shape default
 for 
\begin_inset Formula $100$
\end_inset

-mode and 
\begin_inset Formula $144$
\end_inset

-mode data, respectively.
 The only addition in these scripts compared to the standard extraction
 code is the use of Matlab's 
\shape italic
randperm
\shape default
 function.
 The 
\begin_inset Formula $1\times M$
\end_inset

 random permutation vector applied to each pattern is then saved as 
\shape italic
randp.mat
\shape default
, which is called from the main Matlab directory using the function 
\shape italic
xqpermutation
\shape default
 and set as the par mater 
\shape italic
p.permute
\shape default
.
 This permutation vector is then applied to the rows of the transmission
 matrix for use in phase-space simulations.
 
\end_layout

\begin_layout Standard
More details on random permutations can be found in the appropriate example
 located in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Examples"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

function e = xQSim_165W_experiment()
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

p.name = '144-mode: Waist=65um, power=1.65W';
\end_layout

\begin_layout Plain Layout

p.matrix    = @expmatrix;
\end_layout

\begin_layout Plain Layout

p.M         = 144;
\end_layout

\begin_layout Plain Layout

p.N         = 50;
\end_layout

\begin_layout Plain Layout

p.bits	  = 32;
\end_layout

\begin_layout Plain Layout

p.r         = @expsqueeze;                      
\end_layout

\begin_layout Plain Layout

p.ensembles = [5000,20,12];
\end_layout

\begin_layout Plain Layout

p.t 	    = 1.00;
\end_layout

\begin_layout Plain Layout

p.eps 	  = 0;
\end_layout

\begin_layout Plain Layout

[Count]     = qcountsle(p);
\end_layout

\begin_layout Plain Layout

p.counts    = Count;
\end_layout

\begin_layout Plain Layout

p.mincount  = 10;
\end_layout

\begin_layout Plain Layout

p.cutoff    = 1e-7;
\end_layout

\begin_layout Plain Layout

p.observe   = {@k,@k1};
\end_layout

\begin_layout Plain Layout

p.compare   = {@expk,@expk1};
\end_layout

\begin_layout Plain Layout

p.logs{2}   = [0,1];
\end_layout

\begin_layout Plain Layout

p.diffplot  = {2,2};
\end_layout

\begin_layout Plain Layout

p.glabels   = {{'j'},{'m'}};
\end_layout

\begin_layout Plain Layout

p.olabels   = {'<
\backslash
pi_j(1)>','G^{(M)}(m)'};
\end_layout

\begin_layout Plain Layout

p.xk{2}     = {0:p.M};
\end_layout

\begin_layout Plain Layout

[e,d,cp]    = xQSim(p);
\end_layout

\begin_layout Plain Layout

xGraph(d,cp);
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Subsection
Data structures in xQSim and xGraph
\end_layout

\begin_layout Subsubsection
xQSim inputs
\end_layout

\begin_layout Standard
When 
\emph on
xQSim
\emph default
 is used, it is called with the argument (
\emph on
input
\emph default
).
 Each simulation is defined as a cell array of structures:
\begin_inset Formula 
\[
input:=\{p_{1},p_{2},\ldots\}
\]

\end_inset


\end_layout

\begin_layout Standard
Each structure 
\begin_inset Formula $p$
\end_inset

 contains parameters relevant to a particular step in the sequence:
\begin_inset Formula 
\[
p:=(p.M,p.N,\ldots)
\]

\end_inset

If the sequence has just one member, a structure can be used directly, without
 an enclosing cell array.
\end_layout

\begin_layout Subsubsection
xQSim internal phase-space
\end_layout

\begin_layout Standard
Although this is transparent to the user, each network in the sequence transform
s a matrix of quantum phase-space amplitudes: 
\begin_inset Formula 
\[
\bm{a}:=\left[\bm{\alpha},\bm{\beta}\right]_{j}=a_{ij}
\]

\end_inset


\end_layout

\begin_layout Standard
The first index is the mode index from 
\begin_inset Formula $1,\ldots,2M$
\end_inset

, where indices from 
\begin_inset Formula $1,\ldots,M$
\end_inset

 indicate amplitudes equivalent to 
\begin_inset Formula $\hat{a}_{i}$
\end_inset

, and indices from 
\begin_inset Formula $M+1,\ldots,2M$
\end_inset

 are amplitudes equivalent to 
\begin_inset Formula $\hat{a}_{i}^{\dagger}$
\end_inset

.
 These quantum amplitudes can be recycled in a sequence of network operations.
 
\end_layout

\begin_layout Standard
The second index is from 
\begin_inset Formula $1,\dots,p.ensembles(1)$
\end_inset

, for ensemble averaging using vector parallel processing.
 These transformations are repeated 
\begin_inset Formula $p.ensembles(2)$
\end_inset

 times in a local loop, and 
\begin_inset Formula $p.ensembles(3)$
\end_inset

 times nonlocally, with parallel loops.
 At least one loop ensemble larger than 
\begin_inset Formula $1$
\end_inset

 is required to estimate errors.
\end_layout

\begin_layout Standard
User's can vary between phase-space representations using 
\begin_inset Formula $method$
\end_inset

 which corresponds to the 
\begin_inset Formula $\sigma$
\end_inset

-ordering notation via 
\begin_inset Formula $method=1$
\end_inset

 is equal to 
\begin_inset Formula $\sigma=0$
\end_inset

, 
\begin_inset Formula $method=2$
\end_inset

 to 
\begin_inset Formula $\sigma=1/2$
\end_inset

 and 
\begin_inset Formula $method=3$
\end_inset

 to 
\begin_inset Formula $\sigma=1$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection
xQSim outputs
\end_layout

\begin_layout Standard
The output data is a nested cell array, whose length is the total sequence
 length:
\begin_inset Formula 
\[
data:=\{d_{1},d_{2},\ldots\}
\]

\end_inset

At each step in the sequence, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
a data
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 cell array 
\begin_inset Formula $d$
\end_inset

 of individual quantum expectation values or graphs is generated, where:
\begin_inset Formula 
\[
d:=\{g_{1},g_{2},\ldots\}
\]

\end_inset


\end_layout

\begin_layout Standard
Here each graph 
\begin_inset Formula $g_{n}$
\end_inset

 is the output of the 
\begin_inset Formula $n$
\end_inset

-th defined observe function, described below.
 These are real, multidimensional arrays of the data.
 They include averages calculated by the observe functions, and error-bars
 generated by the 
\begin_inset Formula $qsim$
\end_inset

 code:
\begin_inset Formula 
\[
g:=\left(g_{\ell j_{1}j_{2}\ldots j_{n},e}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
There is a standardized form of 
\begin_inset Formula $g$
\end_inset

.
 The first index 
\begin_inset Formula $\ell$
\end_inset

 is a line index, reserved for subsequent plotting software.
 The next 
\begin_inset Formula $n$
\end_inset

 indices are a multidimensional data array with arbitrary dimensionality.
 If 
\begin_inset Formula $cyc>1$
\end_inset

, 
\begin_inset Formula $j_{1}$
\end_inset

 is the cycle index.
 Other dimensions may correspond to a mode index or to a count number.
 The last index 
\begin_inset Formula $e$
\end_inset

 is an error index, to address the data and sampling error.
 This is also used to index the comparison or experimental data, if it is
 available from the optional compare functions.
\end_layout

\begin_layout Subsubsection
xGraph inputs 
\end_layout

\begin_layout Standard
If 
\emph on
xGraph
\emph default
 is used, it is called with the arguments (
\emph on
input
\emph default
, 
\emph on
data
\emph default
).
 Here 
\begin_inset Formula $input$
\end_inset

 is a cell array, a sequence of graphics structures.
 It can be the same cell array used to define the simulation parameters.
 However, the graphics parameters are a distinct set.
 The 
\begin_inset Formula $data$
\end_inset

 is the output data from xQSim, or some combination of the output data in
 more complex examples.
 One can run 
\emph on
xQSim
\emph default
 multiple times with different parameters to show functional dependences.
 The purpose of xGraph is to allow batch generation of many graphs from
 a multidimensional data array.
\end_layout

\begin_layout Subsection
Observations 
\begin_inset CommandInset label
LatexCommand label
name "sec:Observations-and-comparisons"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
observe
\emph default
 functions are user-specified functions that calculate an observable average
 and return it, given the phase-space amplitude matrix 
\begin_inset Formula $\bm{a}$
\end_inset

.
 Each 
\emph on
observe
\emph default
 function can have arbitrary output dimensionality.
 Each can be assigned its own graphics parameters, and an optional initialize
 function that initializes a given graph, specified by the graph number
 
\begin_inset Formula $n$
\end_inset

.
 Parameters are passed to the observe functions through the parameter structure,
 
\begin_inset Formula $p$
\end_inset

.
 Observe functions are passed as handles, in a cell array, as @x2 (etc).
 
\end_layout

\begin_layout Standard
Standard observe functions provided are:
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Return type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean x quadrature squared per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
p2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean p quadrature squared per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean photon number per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean number moments in sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean clicks per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
km
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean click moments in sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
km2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean click moments over two sequential channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
km3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean click moments over three sequential channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kmsub
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean subset of click moments per CO channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Click probability - single partition
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kn
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Click probability - n-fold partition
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
List of observe functions
\end_layout

\begin_layout Subsubsection
x2
\end_layout

\begin_layout Standard
This computes the x quadrature moment per channel, 
\begin_inset Formula $\left\langle \hat{x}_{k}^{2}\right\rangle $
\end_inset

.
\end_layout

\begin_layout Subsubsection
p2
\end_layout

\begin_layout Standard
This computes the p quadrature moment per channel, 
\begin_inset Formula $\left\langle \hat{p}_{k}^{2}\right\rangle $
\end_inset

.
\end_layout

\begin_layout Subsubsection
n
\end_layout

\begin_layout Standard
This computes the mean photon number per channel, 
\begin_inset Formula $\left\langle \hat{a}_{k}^{\dagger}\hat{a}_{k}\right\rangle =\left\langle \hat{n}_{k}\right\rangle $
\end_inset

.
\end_layout

\begin_layout Subsubsection
nm
\end_layout

\begin_layout Standard
This computes the mean photon number correlation over adjacent channels,
 
\begin_inset Formula $\left\langle \hat{n}_{1}\hat{n}_{2}\dots\hat{n}_{k}\right\rangle $
\end_inset

.
 The correlation order values are input as a cell array of index vectors,
 
\begin_inset Formula $p.O{n}=[k_{1},k_{2},..].$
\end_inset


\end_layout

\begin_layout Subsubsection
k
\end_layout

\begin_layout Standard
This computes the mean clicks per channel, from the click projectors, 
\begin_inset Formula $\left\langle \hat{\pi}_{k}\left(1\right)\right\rangle $
\end_inset

.
\end_layout

\begin_layout Subsubsection
km
\end_layout

\begin_layout Standard
This computes the mean click correlation over a list of channels, 
\begin_inset Formula $\left\langle \hat{\pi}_{1}\left(1\right)\hat{\pi}_{2}\left(1\right),\dots\hat{\pi}_{k}\left(1\right)\right\rangle $
\end_inset

.
 The correlation order values are input as a cell array of index vectors,
 
\begin_inset Formula $p.O{n}=[k_{1},k_{2},..].$
\end_inset


\end_layout

\begin_layout Subsubsection
km2
\end_layout

\begin_layout Standard
This computes the mean click correlation over two channels, 
\begin_inset Formula $\left\langle \hat{\pi}_{j}\left(1\right)\hat{\pi}_{k}\left(1\right)\right\rangle $
\end_inset

, where 
\begin_inset Formula $j<k$
\end_inset

.
 The number of possible combinations follows the binomial coefficient 
\begin_inset Formula $\binom{M}{n}$
\end_inset

, where 
\begin_inset Formula $M$
\end_inset

 is the number of modes and 
\begin_inset Formula $n$
\end_inset

 is the correlation order which is input as the integer 
\begin_inset Formula $p.CO$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection
km3
\end_layout

\begin_layout Standard
This computes the mean click correlation over three channels 
\begin_inset Formula $\left\langle \hat{\pi}_{j}\left(1\right)\hat{\pi}_{k}\left(1\right)\hat{\pi}_{h}\left(1\right)\right\rangle $
\end_inset

, where 
\begin_inset Formula $j<k<h$
\end_inset

.
 The number of possible combinations follows the binomial coefficient 
\begin_inset Formula $\binom{M}{n}$
\end_inset

, where 
\begin_inset Formula $M$
\end_inset

 is the number of modes and 
\begin_inset Formula $n$
\end_inset

 is the correlation order which is input as the integer 
\begin_inset Formula $p.CO$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection
kmsub
\end_layout

\begin_layout Standard
This computes the first 
\begin_inset Formula $M-CO$
\end_inset

 mean click correlations from a possible 
\begin_inset Formula $\binom{M}{n}$
\end_inset

.
 This gives a more graphically appealing output than 
\begin_inset Formula $km2$
\end_inset

 and 
\begin_inset Formula $km3$
\end_inset

 observables.
 
\end_layout

\begin_layout Subsubsection
k1
\end_layout

\begin_layout Standard
This calculates the total click probability in a partition of channels.
 The partition indices can be input as a cell array giving the number of
 channels, if the channels are numbered from 
\begin_inset Formula $1\ldots p.Part\{n\}$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection
kn
\end_layout

\begin_layout Standard
This calculates the total click probability in a multi-dimensional partition
 of channels.
 The partition values can be input as a cell array of vectors containing
 the number of channels, if the channels are numbered sequentially from
 
\begin_inset Formula $1\ldots p.Part\{1\}$
\end_inset

.
 Otherwise, the individual channel number vectors are input in a nested
 cell array of vectors.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
his calculates the Torontonian, the probability of a particular click sequence
 identified by a binary number 
\begin_inset Formula $C=01001...$
\end_inset

.
 The phase-space equation for this is:
\begin_inset Formula 
\[
T\left(C\right)=\left\langle \prod\hat{\pi}\left(C_{i}\right)\right\rangle =\left\langle \prod\left[\pi_{i}\left(1\right)^{C_{i}}\pi_{i}\left(0\right)^{\left(1-C_{i}\right)}\right]\right\rangle 
\]

\end_inset

where 
\begin_inset Formula $\pi_{i}\left(0\right)=\exp-n_{i}$
\end_inset

 and 
\begin_inset Formula $\pi_{i}\left(1\right)=1-\pi_{i}\left(0\right)$
\end_inset

.
 There are 
\begin_inset Formula $2^{m}$
\end_inset

 outputs, indexed from 
\begin_inset Formula $C=0$
\end_inset

, so this is only useful for small arrays.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Comparisons
\end_layout

\begin_layout Standard
The 
\emph on
compare
\emph default
 function is a user-specified function that evaluates a function and returns
 it.
 This is used for testing and also to input experimental data for comparisons.
 The comparisons may include error data, which can be zero for exact results.
 Comparisons are also plotted using 
\emph on
compare
\emph default
.
 This generates additional comparison plots, as well as error totals that
 are converted into a 
\begin_inset Formula $\chi^{2}$
\end_inset

- error estimate when there are statistical variances available.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Return type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x2c
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean x quadrature squared per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
p2c
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean p quadrature squared per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nc
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean photon number per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nmc
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean number moments in sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kc
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean clicks per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kmc
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean click moments in sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
km2c
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean clicks per two channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
km3c
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean clicks per three channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kmsubc
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean subset of clicks per CO channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k1c
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Click probability - single partition
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
knc
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Click probability - n-fold partition
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
In all analytic comparisons, there are two options:
\end_layout

\begin_layout Itemize
an identity transmission matrix can be used with an arbitrary Gaussian input,
 uniform or non-uniform.
\end_layout

\begin_layout Itemize
any unitary with a scaled transmission (
\begin_inset Formula $t\le1$
\end_inset

) can be used with a fully thermalized (
\begin_inset Formula $eps=1$
\end_inset

), uniform input.
 
\end_layout

\begin_layout Subsubsection
x2c
\end_layout

\begin_layout Standard
This compares the analytic x quadrature moment per channel, 
\begin_inset Formula $\left\langle \hat{x}^{2}\right\rangle $
\end_inset

.
\end_layout

\begin_layout Subsubsection
p2c
\end_layout

\begin_layout Standard
This compares the analytic p quadrature moment per channel, 
\begin_inset Formula $\left\langle \hat{p}^{2}\right\rangle $
\end_inset

.
\end_layout

\begin_layout Subsubsection
nc
\end_layout

\begin_layout Standard
This gives a comparison of photon numbers per channel.
\end_layout

\begin_layout Subsubsection
nmc
\end_layout

\begin_layout Standard
This comparison of number moments uses the same input as 
\series bold
nm
\series default
.
\end_layout

\begin_layout Subsubsection
kc
\end_layout

\begin_layout Standard
This comparison of click probabilities per channel uses the same input as
 
\series bold
k
\series default
.
\end_layout

\begin_layout Subsubsection
kmc
\end_layout

\begin_layout Standard
This comparison of click moments uses the same input as 
\series bold
km
\series default
.
\end_layout

\begin_layout Subsubsection
km2c
\end_layout

\begin_layout Standard
This comparison of all combinations of click probabilities over two channels
 uses the same input as 
\series bold
km2
\series default
.
 
\end_layout

\begin_layout Subsubsection
km3c
\end_layout

\begin_layout Standard
This comparison of all combinations of click probabilities over three channels
 uses the same input as 
\series bold
km3
\series default
.
 
\end_layout

\begin_layout Subsubsection
kmsubc
\end_layout

\begin_layout Standard
This comparison of a subset of all combinations of click probabilities over
 sequential channels uses the same input as 
\series bold
kmsub
\series default
.
 
\end_layout

\begin_layout Subsubsection
k1c
\end_layout

\begin_layout Standard
In this comparison the clicks are split into an n-fold partition, using
 the same input as 
\series bold
k1
\series default
.
\end_layout

\begin_layout Subsubsection
knc
\end_layout

\begin_layout Standard
In this comparison the clicks are split into an n-fold partition, using
 the same input as 
\series bold
kn
\series default
.
\end_layout

\begin_layout Section
Experimental data
\begin_inset CommandInset label
LatexCommand label
name "sec:Experimental-data"

\end_inset


\end_layout

\begin_layout Standard
This is generated by the Matlab program qcounts.m, which analyses experimental
 count data, from binary files in *.bin.
 It generates individual Matlab data files for each observable and records
 the total number of valid counts, which are also saved in the data files.
 All experimental data should be on the Matlab path if comparisons are required.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
@expmatrix
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function handle
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental matrix, loaded in xQSim
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
@expsqueeze
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function handle
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental squeezing data, loaded in xQSim
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental clicks per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expkm.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental 
\begin_inset Formula $K$
\end_inset

-th order moment 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk2m.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
All experimental second order click correlations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk2ms.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Subset of experimental second order click correlations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk3m.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
All experimental third order click correlations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk3ms.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Subset of experimental third order click correlations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk4ms.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Subset of experimental fourth order click correlations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk1.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental single partition clicks
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk2.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental two-fold partition clicks
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
expk4.mat
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental four-fold partition clicks
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Experimental comparisons
\end_layout

\begin_layout Standard
Using the 
\emph on
compare
\emph default
 function, experimental data is called from user specified functions which
 also sets error data to zero.
 Experimental error data is then calculated in xQSim and, following the
 
\begin_inset Formula $\chi$
\end_inset

-squared theory below, is converted into a 
\begin_inset Formula $\chi$
\end_inset

-squared error estimate.
 Experimental comparison functions are located in qDATA.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - Clicks per channel
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expkm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - 
\begin_inset Formula $K$
\end_inset

-th order moment
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk2m
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - All combinations of clicks per two channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk2ms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - Subset of clicks per two channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk3m
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - All combinations of clicks per three channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk3ms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - Subset of clicks per three channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk4ms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - Subset of clicks per four channels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - single partition
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
matrix
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - two-fold partition
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
expk4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
matrix
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experimental click probability - four-fold partition
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
expk
\end_layout

\begin_layout Standard
In this comparison of experimental click probability per channel, experimental
 data is loaded from 
\emph on
expk.mat
\emph default
.
\end_layout

\begin_layout Subsection
expkm
\end_layout

\begin_layout Standard
In this comparison of experimental click probability per channel, experimental
 data is loaded from 
\emph on
expkm.mat
\emph default
.
\end_layout

\begin_layout Subsection
expk2m
\end_layout

\begin_layout Standard
In this comparison of experimental click probabilities for all combinations
 of two output channels, experimental data is loaded from 
\emph on
expk2m.mat
\emph default
.
\end_layout

\begin_layout Subsection
expk2ms
\end_layout

\begin_layout Standard
In this comparison of experimental click probabilities for a subset of all
 two channel combinations, experimental data is loaded from 
\emph on
expk2ms.mat
\emph default
.
\end_layout

\begin_layout Subsection
expk3m
\end_layout

\begin_layout Standard
In this comparison of experimental click probabilities for all combinations
 of three output channels, experimental data is loaded from 
\emph on
expk3m.mat
\emph default
.
\end_layout

\begin_layout Subsection
expk3ms
\end_layout

\begin_layout Standard
In this comparison of experimental click probabilities for a subset of all
 three channel combinations, experimental data is loaded from 
\emph on
expk3ms.mat
\emph default
.
\end_layout

\begin_layout Subsection
expk4ms
\end_layout

\begin_layout Standard
In this comparison of experimental click probabilities for a subset of all
 four channel combinations, experimental data is loaded from 
\emph on
expk4ms.mat
\emph default
.
\end_layout

\begin_layout Subsection
expk1
\end_layout

\begin_layout Standard
In this comparison of experimental click probability for a single partition
 of all channels, data is loaded from 
\emph on
expk1.mat
\emph default
.
\end_layout

\begin_layout Subsection
expk2
\end_layout

\begin_layout Standard
In this comparison of experimental click probability for an equal two-fold
 partition of all channels, data is loaded from 
\emph on
expk2.mat
\emph default
.
\end_layout

\begin_layout Subsection
expk4
\end_layout

\begin_layout Standard
In this comparison of experimental click probability for four-fold partition
 of all channels, data is loaded from 
\emph on
expk4.mat
\emph default
.
\end_layout

\begin_layout Section
Examples
\begin_inset CommandInset label
LatexCommand label
name "sec:Examples"

\end_inset


\end_layout

\begin_layout Standard
The folder 
\shape italic
xQSimExamples
\shape default
 contains a variety of examples for different mode numbers, input states
 and observables.
 Individual tests can be performed or all can be run using batch test scripts
 
\shape italic
xQSim_GBStestM.m
\shape default
, where 
\begin_inset Formula $M$
\end_inset

 varies between 
\begin_inset Formula $M=20,40,100$
\end_inset

 for different batch tests.
 
\end_layout

\begin_layout Standard
The examples presented in this manual are slightly modified versions of
 the examples given in 
\shape italic
xQSimExamples
\shape default
.
 
\end_layout

\begin_layout Subsection
Squeezed thermalized state examples
\begin_inset CommandInset label
LatexCommand label
name "subsec:Squeezed-thermalised-state-example"

\end_inset


\end_layout

\begin_layout Standard
Using the exact derivation of click projectors outlined in subsection.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exact-click"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for the comparison functions, special multimode test cases are used, in
 which all output events are independent.
 This is obtainable either from having arbitrary independent thermalized
 squeezed inputs and a diagonal transmission matrix, or else by having a
 uniform, fully thermalized input together with an arbitrary unitary transmissio
n matrix.
\end_layout

\begin_layout Standard
Either of these cases lead to independent outputs in which each mode is
 in a Gaussian state.
 The simplest case is for a uniform output in which 
\begin_inset Formula $\left\langle \hat{\pi}\left(1\right)\right\rangle =p$
\end_inset

 is constant.
 In this case, the probability of 
\begin_inset Formula $m$
\end_inset

 total clicks in 
\begin_inset Formula $M$
\end_inset

 channels has a probability of:
\begin_inset Formula 
\begin{equation}
P\left(m\right)=\frac{M!p^{m}\left(1-p\right)^{M-m}}{m!\left(M-m\right)!}.
\end{equation}

\end_inset

Two examples of this are given below.
 
\end_layout

\begin_layout Subsubsection
Uniform squeezing
\end_layout

\begin_layout Standard
This example generates total count probabilities for the case of pure squeezed
 state inputs with uniform squeezing 
\begin_inset Formula $\boldsymbol{r}=[1,\dots,1]$
\end_inset

.
 The transmission matrix is an 
\begin_inset Formula $N\times M$
\end_inset

 identity matrix with 
\begin_inset Formula $M=N=20$
\end_inset

 and a transmission coefficient of 
\begin_inset Formula $t=0.5$
\end_inset

.
 
\end_layout

\begin_layout Standard
In this case, the 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistical test outputs give 
\begin_inset Formula $\chi^{2}/k\approx1\pm0.3$
\end_inset

 and the 
\begin_inset Formula $Z$
\end_inset

-statistic gives 
\begin_inset Formula $Z\approx1\pm2$
\end_inset

.
 This indicates that the statistical test is satisfied.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

function e1 = xQSim_uni_sq_test20( )
\end_layout

\begin_layout Plain Layout

p.matrix     = @Identity;
\end_layout

\begin_layout Plain Layout

p.M          = 20;
\end_layout

\begin_layout Plain Layout

p.N          = 20;
\end_layout

\begin_layout Plain Layout

p.name       = sprintf('+P uniform squeezed, M=%d',p.M);
\end_layout

\begin_layout Plain Layout

p.t          = 0.5;
\end_layout

\begin_layout Plain Layout

p.r          = ones(1,p.M);
\end_layout

\begin_layout Plain Layout

p.eps        = zeros(1,p.M);
\end_layout

\begin_layout Plain Layout

p.Part{1}    = p.M;
\end_layout

\begin_layout Plain Layout

p.ensembles  = [1000,100,12];
\end_layout

\begin_layout Plain Layout

p.cutoff     = 1.e-7;
\end_layout

\begin_layout Plain Layout

p.observe    = {@k1};
\end_layout

\begin_layout Plain Layout

p.compare    = {@k1c};
\end_layout

\begin_layout Plain Layout

p.glabels    = {{'Clicks m'}};
\end_layout

\begin_layout Plain Layout

p.olabels    = {'G_1(m)'};
\end_layout

\begin_layout Plain Layout

p.diffplot   = {2};
\end_layout

\begin_layout Plain Layout

p.xk{1}      = {0:p.M};
\end_layout

\begin_layout Plain Layout

[e1,d,cp]    = xqsim(p);
\end_layout

\begin_layout Plain Layout

xgraph(d,cp);
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_uni_sq_fig.eps
	width 50text%

\end_inset


\begin_inset Graphics
	filename xQSim_uni_sq_diff_fig.eps
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Example: 
\begin_inset Formula $M=20$
\end_inset

 mode linear network with uniform squeezed state inputs.
 Left graph is simulation versus exact total count probabilities.
 Right plot is the normalized difference between simulated (solid line)
 and exact (dotted line) distributions.
 Simulations obtained for 
\begin_inset Formula $1.2\times10^{6}$
\end_inset

 ensembles.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Thermal state
\end_layout

\begin_layout Standard
This example generates total count probabilities for the case of thermal
 state inputs with squeezing parameter 
\begin_inset Formula $\boldsymbol{r}=[1,\dots,1]$
\end_inset

 and 
\begin_inset Formula $\epsilon=1$
\end_inset

.
 The transmission matrix is an 
\begin_inset Formula $N\times M$
\end_inset

 Haar random unitary with 
\begin_inset Formula $M=N=100$
\end_inset

 and a transmission coefficient of 
\begin_inset Formula $t=0.5$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Formula $\chi^{2}$
\end_inset

 statistical test outputs give 
\begin_inset Formula $\chi^{2}/k\approx1\pm0.4$
\end_inset

 for 
\begin_inset Formula $k=45$
\end_inset

 valid bins whilst the 
\begin_inset Formula $Z$
\end_inset

-statistic gives 
\begin_inset Formula $Z\approx1.5\pm2$
\end_inset

.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

function e1 = xQSim_thermal_test100( )
\end_layout

\begin_layout Plain Layout

p.matrix     = @Unitary;
\end_layout

\begin_layout Plain Layout

p.M          = 100;
\end_layout

\begin_layout Plain Layout

p.N          = 100;
\end_layout

\begin_layout Plain Layout

p.name       = sprintf('+P  unitary thermal, M=%d',p.M);
\end_layout

\begin_layout Plain Layout

p.t          = 0.5;
\end_layout

\begin_layout Plain Layout

p.r          = ones(1,p.M);
\end_layout

\begin_layout Plain Layout

p.eps        = ones(1,p.M);
\end_layout

\begin_layout Plain Layout

p.Part{1}    = p.M;
\end_layout

\begin_layout Plain Layout

p.ensembles  = [1000,100,12];
\end_layout

\begin_layout Plain Layout

p.cutoff     = 1.e-7;
\end_layout

\begin_layout Plain Layout

p.observe    = {@k1};
\end_layout

\begin_layout Plain Layout

p.compare    = {@k1c};
\end_layout

\begin_layout Plain Layout

p.glabels    = {{'Clicks m'}};
\end_layout

\begin_layout Plain Layout

p.olabels    = {'G_1(m)'};
\end_layout

\begin_layout Plain Layout

p.diffplot   = {2};
\end_layout

\begin_layout Plain Layout

p.xk{1}      = {0:p.M};
\end_layout

\begin_layout Plain Layout

[e1,d,cp]    = xqsim(p);
\end_layout

\begin_layout Plain Layout

xgraph(d,cp);
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_therm_fig.eps
	width 50text%

\end_inset


\begin_inset Graphics
	filename xQSim_therm_diff_fig.eps
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Example: 
\begin_inset Formula $M=100$
\end_inset

 mode linear network with thermal state inputs.
 Left graph is simulation versus exact total count probabilities.
 Right plot is the normalized difference between simulated (solid line)
 and exact (dotted line) distributions.
 Simulations obtained for 
\begin_inset Formula $1.2\times10^{6}$
\end_inset

 ensembles.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Multidimensional binning
\end_layout

\begin_layout Standard
This example generates output GCPs in two and four dimensions for the case
 of non-uniform squeezed inputs.
 The transmission matrix is an 
\begin_inset Formula $N\times M$
\end_inset

 identity matrix with 
\begin_inset Formula $M=N=40$
\end_inset

 and a transmission coefficient of 
\begin_inset Formula $t=0.5$
\end_inset

.
 
\end_layout

\begin_layout Standard
For simulations with 
\begin_inset Formula $d>1$
\end_inset

, xGraph generates four output plots; two 3D surface plots and two 2D plots.
 When 
\begin_inset Formula $d=2$
\end_inset

, one surface plot is the full two-dimensional distribution, whilst the
 other is the difference comparison plot.
 For 
\begin_inset Formula $d>2$
\end_inset

 the surface plots are then two-dimensional planar slices of, by default,
 grouped counts 
\begin_inset Formula $m_{1},m_{2}$
\end_inset

 although this can be changed.
 Standard 2D plot outputs are always one-dimensional slices of surface plots.
 
\end_layout

\begin_layout Standard
Two-dimensional comparisons give 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistical test outputs of 
\begin_inset Formula $\chi^{2}/k\approx1\pm0.5$
\end_inset

 for 
\begin_inset Formula $k=169$
\end_inset

 valid bins whilst the 
\begin_inset Formula $Z$
\end_inset

-statistic gives 
\begin_inset Formula $Z\approx0.7\pm2$
\end_inset

.
 Four-dimensional comparisons give 
\begin_inset Formula $\chi^{2}/k\approx1\pm0.5$
\end_inset

 for 
\begin_inset Formula $k=2083$
\end_inset

 valid bins and 
\begin_inset Formula $Z\approx1.4\pm2$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

function e1 = xQSim_non_uni_sq_test40( )
\end_layout

\begin_layout Plain Layout

p.matrix     = @Identity;
\end_layout

\begin_layout Plain Layout

p.M          = 40;
\end_layout

\begin_layout Plain Layout

p.N          = 40;
\end_layout

\begin_layout Plain Layout

p.name       = sprintf('+P non-uniform squeezed, M=%d',p.M);
\end_layout

\begin_layout Plain Layout

p.t          = 0.5;
\end_layout

\begin_layout Plain Layout

I            = ones(1,p.M/5);
\end_layout

\begin_layout Plain Layout

p.r          = [I/4,2*I,4*I,I/2,I];
\end_layout

\begin_layout Plain Layout

p.eps        = zeros(1,p.M);
\end_layout

\begin_layout Plain Layout

p.Part{1}    = [p.M/2, p.M/2];
\end_layout

\begin_layout Plain Layout

p.Part{2}    = [p.M/4, p.M/4,p.M/4,p.M/4];
\end_layout

\begin_layout Plain Layout

p.ensembles  = [1000,100,12];
\end_layout

\begin_layout Plain Layout

p.cutoff     = 1.e-7;
\end_layout

\begin_layout Plain Layout

p.observe    = {@kn,@kn};
\end_layout

\begin_layout Plain Layout

p.compare    = {@knc,@knc};
\end_layout

\begin_layout Plain Layout

p.glabels    = {{'Clicks m_1','Clicks m_2'},...
\end_layout

\begin_layout Plain Layout

     {'Clicks m_1','Clicks m_2','Clicks m_3','Clicks m_4'}};
\end_layout

\begin_layout Plain Layout

p.olabels    = {'G_2(m)','G_4(m)'};
\end_layout

\begin_layout Plain Layout

p.diffplot   = {2,2};
\end_layout

\begin_layout Plain Layout

p.xk{1}      = {0:p.M/2,0:p.M/2};
\end_layout

\begin_layout Plain Layout

p.xk{2}      = {0:p.M/4,0:p.M/4,0:p.M/4,0:p.M/4};
\end_layout

\begin_layout Plain Layout

[e1,d,cp]    = xqsim(p);
\end_layout

\begin_layout Plain Layout

xgraph(d,cp);
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_non_uni_sq_2D_fig.eps
	width 50text%

\end_inset


\begin_inset Graphics
	filename xQSim_non_uni_sq_2D_diff_fig.eps
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Example: 
\begin_inset Formula $M=40$
\end_inset

 mode linear network with non-uniform squeezed state inputs.
 Left surface plot is simulation versus exact two-dimensional output probability
 for all 
\begin_inset Formula $21^{2}$
\end_inset

 data points.
 Right plot is the normalized difference between simulated and exact distributio
ns.
 Simulations obtained for 
\begin_inset Formula $1.2\times10^{6}$
\end_inset

 ensembles.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_non_uni_sq_4D_fig.eps
	width 50text%

\end_inset


\begin_inset Graphics
	filename xQSim_non_uni_sq_4D_diff_fig.eps
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Example: 
\begin_inset Formula $M=40$
\end_inset

 mode linear network with non-uniform squeezed state inputs.
 Left surface plot is a two-dimensional planar slice of simulation versus
 exact four-dimensional output probability for 
\begin_inset Formula $11^{2}$
\end_inset

 data points.
 Right plot is the normalized difference between simulated and exact distributio
ns.
 Simulations obtained for 
\begin_inset Formula $1.2\times10^{6}$
\end_inset

 ensembles.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Phase-space comparisons
\end_layout

\begin_layout Standard
This example generates intensity correlation moments, 
\begin_inset Formula $\left\langle \hat{n}'_{1}\dots\hat{n}'_{j}\right\rangle $
\end_inset

, of orders 
\begin_inset Formula $1\rightarrow5$
\end_inset

 for non-uniform thermalized squeezed state inputs in the positive-P, Wigner
 and Q phase-space representations with 
\begin_inset Formula $\epsilon=0.5$
\end_inset

.
 The transmission matrix is an 
\begin_inset Formula $N\times M$
\end_inset

 identity matrix with 
\begin_inset Formula $M=N=20$
\end_inset

 and a transmission coefficient of 
\begin_inset Formula $t=0.5$
\end_inset

.
\end_layout

\begin_layout Standard
Changing between representations is simple and can be performed on one script
 as shown below.
 However, Wigner and Q representations can only be used to compute observables
 with photon number outputs or quadrature operator moments.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

function e1 = xQSim_ps_test20( )
\end_layout

\begin_layout Plain Layout

p.matrix     = @Identity;
\end_layout

\begin_layout Plain Layout

p.M          = 20;
\end_layout

\begin_layout Plain Layout

p.N          = 20;
\end_layout

\begin_layout Plain Layout

p.name       = sprintf('+P non-uniform thermalized, M=%d',p.M);
\end_layout

\begin_layout Plain Layout

p.t          = 0.5;
\end_layout

\begin_layout Plain Layout

I            = ones(1,p.M/5);
\end_layout

\begin_layout Plain Layout

p.r          = [I/4,2*I,4*I,I/2,I];
\end_layout

\begin_layout Plain Layout

p.eps        = 0.5*ones(1,p.M);
\end_layout

\begin_layout Plain Layout

p.O{1}       = 1:5;
\end_layout

\begin_layout Plain Layout

p.ensembles  = [1000,100,12];
\end_layout

\begin_layout Plain Layout

p.cutoff     = 1.e-7;
\end_layout

\begin_layout Plain Layout

p.observe    = {@nm};
\end_layout

\begin_layout Plain Layout

p.compare    = {@nmc};
\end_layout

\begin_layout Plain Layout

p.glabels    = {{'Order'}};
\end_layout

\begin_layout Plain Layout

p.olabels    = {'<n_1...n_j>'};
\end_layout

\begin_layout Plain Layout

p.diffplot   = {2};
\end_layout

\begin_layout Plain Layout

p.xk{1}      = p.O(4);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

pW          = p;
\end_layout

\begin_layout Plain Layout

pW.method   = 2;
\end_layout

\begin_layout Plain Layout

pW.name     = sprintf('W non-uniform thermalized, M=%d',p.M);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

pQ          = p;
\end_layout

\begin_layout Plain Layout

pQ.method   = 3;
\end_layout

\begin_layout Plain Layout

pQ.name     = sprintf('Q non-uniform thermalized, M=%d',p.M);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

[e1,d,cp]    = xqsim({p,pW,pQ});
\end_layout

\begin_layout Plain Layout

xgraph(d,cp);
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_non_uni_th_+P_fig.eps
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_non_uni_th_W_fig.eps
	width 50col%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_non_uni_th_Q_fig.eps
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Example: Intensity correlation moments versus correlation order.
 Simulations are denoted by the solid line and use the positive-P (top),
 Wigner (middle) and Q (bottom) representations whilst the dashed lines
 denotes exactly computed correlation moments.
 While the normally ordered positive-P probabilities agree with the exact
 calculations, the Wigner and Q representations deviate significantly from
 exact calculations which increase with correlation order.
 This deviation is due to vacuum fluctuations causing sampling errors increasing
 with correlation order.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Experimental examples
\end_layout

\begin_layout Standard
This subsection contains examples for simulations using experimental data
 from the 
\begin_inset Formula $100$
\end_inset

-mode implementation of Zhong et al 
\begin_inset CommandInset citation
LatexCommand cite
key "Raw100,zhong2020quantum"
literal "false"

\end_inset

.
 Although multiple examples are given in the 
\shape italic
xQSimExamples
\shape default
 folder, we focus on generating comparisons of higher-order click correlations
 and random permutations of binary patterns in this manual.
 
\end_layout

\begin_layout Subsubsection
High-order correlations
\end_layout

\begin_layout Standard
This example generates comparisons of click correlation moments of first
 and second order which are defined as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left\langle \hat{\pi}_{j}(1)\right\rangle 
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left\langle \hat{\pi}_{j}(1)\hat{\pi}_{k}(1)\right\rangle .
\]

\end_inset


\end_layout

\begin_layout Standard
Comparisons can be obtained for all possible combinations of output modes,
 which follows the binomial coefficient 
\begin_inset Formula $\binom{M}{n}$
\end_inset

, or for a subset of these combinations.
 The subset comparisons are preferable for graphing, whilst the full comparison
 of output modes is preferable for statistical tests to ensure all possible
 correlations are observed.
 Not observing all correlations will alter the statistical test outputs
 as there are fewer valid bins.
 
\end_layout

\begin_layout Standard
Inputs are thermalized squeezed states with decoherence coefficient 
\begin_inset Formula $eps=0.0932$
\end_inset

 and transmission 
\begin_inset Formula $t=1.0235$
\end_inset

.
 Simulations were performed for 
\begin_inset Formula $1.44\times10^{7}$
\end_inset

 ensembles.
 First-order correlations have statistical test outputs of 
\begin_inset Formula $\chi^{2}/k\approx5.25\times10^{3}$
\end_inset

 and 
\begin_inset Formula $Z\approx347$
\end_inset

, for 
\begin_inset Formula $k=100$
\end_inset

, whilst second-order marginals give 
\begin_inset Formula $\chi^{2}/k\approx4.99\times10^{3}$
\end_inset

 and 
\begin_inset Formula $Z\approx2.4\times10^{3}$
\end_inset

, for 
\begin_inset Formula $k=4950$
\end_inset

.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

function e = xQSim_experiment_HOC( )
\end_layout

\begin_layout Plain Layout

p.name      = 'Click correlation,M=100'
\end_layout

\begin_layout Plain Layout

p.matrix    = @expmatrix;
\end_layout

\begin_layout Plain Layout

p.M         = 100;
\end_layout

\begin_layout Plain Layout

p.N         = 50;
\end_layout

\begin_layout Plain Layout

p.r         = @expsqueeze;
\end_layout

\begin_layout Plain Layout

p.CO{2}     = 2;
\end_layout

\begin_layout Plain Layout

p.CO{3}     = 2;
\end_layout

\begin_layout Plain Layout

p.ensembles = [6000,200,12];
\end_layout

\begin_layout Plain Layout

p.t         = 1.0235;
\end_layout

\begin_layout Plain Layout

p.eps       = 0.0932;
\end_layout

\begin_layout Plain Layout

p.counts    = 51392341;
\end_layout

\begin_layout Plain Layout

p.mincount  = 10;
\end_layout

\begin_layout Plain Layout

p.cutoff    = 1e-7;
\end_layout

\begin_layout Plain Layout

p.observe   = {@k,@kmsub,@km2};
\end_layout

\begin_layout Plain Layout

p.compare   = {@expk,@expk2ms,@expk2m};
\end_layout

\begin_layout Plain Layout

p.diffplot  = {2,2,2};
\end_layout

\begin_layout Plain Layout

p.glabels   = {{'j'},{'j,k'}{'j<k'}};
\end_layout

\begin_layout Plain Layout

p.olabels   = {'<
\backslash
pi_j(1)>','G^{(2)}','<
\backslash
pi_j(1)
\backslash
pi_k(1)>'};
\end_layout

\begin_layout Plain Layout

p.xk{2}     = {0:p.M-1};
\end_layout

\begin_layout Plain Layout

p.xk{3}     = {0:4950};
\end_layout

\begin_layout Plain Layout

[e,d,cp]    = xqsim(p);
\end_layout

\begin_layout Plain Layout

xgraph(d,cp);
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_exp_FO_fig.eps
	width 50text%

\end_inset


\begin_inset Graphics
	filename xQSim_exp_SO_fig.eps
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Example: Comparisons of click correlations of experiment (dashed line) versus
 theory (solid line).
 The left graph plots correlations of first-order for all possible combinations
 of output modes.
 Right graph contains only the first 
\begin_inset Formula $99$
\end_inset

 second-order correlations for graphical simplicity.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Random permutations
\end_layout

\begin_layout Standard
This example generates comparisons of two-dimensional GCPs for binary patterns
 that have been randomly permuted.
 Inputs are thermalized squeezed states with decoherence coefficient 
\begin_inset Formula $eps=0.0932$
\end_inset

 and transmission 
\begin_inset Formula $t=1.0235$
\end_inset

.
 Data for three random permutations from this experiment are available in
 the folder 
\shape italic
xQSimGBSExperiments
\shape default
, however more can be readily obtained.
 
\end_layout

\begin_layout Standard
Permutations are input through the parameter 
\shape italic
p.permute
\shape default
, which is assumed to be a 
\begin_inset Formula $1\times M$
\end_inset

 row vector, and are applied to the transmission matrix, changing the row
 order according to the mode ordering of the permutation.
 User's can either manually permute output modes, e.g.
 
\begin_inset Formula $p.permute=[15,8,44,\dots]$
\end_inset

, or use permutations generated from data extraction algorithms which are
 loaded from relevant .mat files by the function 
\shape italic
xqpermutation
\shape default
 (see subsection.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Data-extraction"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Note, manual permutation vectors are only applied to the transmission matrix
 rows, not the binary data which must be permuted before being binned.
 
\end_layout

\begin_layout Standard
Simulations can then be performed, with total count and click correlations
 unaffected by the permutation.
 Since each permutation produces comparisons of different correlations,
 each test will output different 
\begin_inset Formula $\chi^{2}$
\end_inset

 and 
\begin_inset Formula $Z$
\end_inset

-statistic results as well as normalized difference graphs.
 An example of this is given in the below figure.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

function e = xQSim_experiment_permute( )
\end_layout

\begin_layout Plain Layout

p.name      = 'Random permutation 1'
\end_layout

\begin_layout Plain Layout

p.matrix    = @expmatrix;
\end_layout

\begin_layout Plain Layout

p.M         = 100;
\end_layout

\begin_layout Plain Layout

p.N         = 50;
\end_layout

\begin_layout Plain Layout

p.r         = @expsqueeze;
\end_layout

\begin_layout Plain Layout

p.Part{3}   = [50, 50];
\end_layout

\begin_layout Plain Layout

p.Part{4}   = [25,25,25,25];
\end_layout

\begin_layout Plain Layout

p.ensembles = [5000,20,12];
\end_layout

\begin_layout Plain Layout

p.t         = 1.0235;
\end_layout

\begin_layout Plain Layout

p.eps       = 0.0932;
\end_layout

\begin_layout Plain Layout

p.counts    = 51392341;
\end_layout

\begin_layout Plain Layout

p.mincount  = 10;
\end_layout

\begin_layout Plain Layout

p.cutoff    = 1e-7;
\end_layout

\begin_layout Plain Layout

p.permute   = xqpermutation;
\end_layout

\begin_layout Plain Layout

p.observe   = {@k,@k1,@kn};
\end_layout

\begin_layout Plain Layout

p.compare   = {@expk,@expk1,@expk2};
\end_layout

\begin_layout Plain Layout

p.logs{2}   = [0,1];
\end_layout

\begin_layout Plain Layout

p.logs{3}   = [0,0,1];
\end_layout

\begin_layout Plain Layout

p.diffplot  = {2,2,2};
\end_layout

\begin_layout Plain Layout

p.glabels   = {{'j'},{'m'},{'Clicks m_1','Clicks m_2'}};
\end_layout

\begin_layout Plain Layout

p.olabels   = {'<
\backslash
pi_j(1)>','G_1(m)','G_2(m)'};
\end_layout

\begin_layout Plain Layout

p.xk{2}     = {0:p.M};
\end_layout

\begin_layout Plain Layout

p.xk{3}     = {0:50,0:50};
\end_layout

\begin_layout Plain Layout

[e,d,cp]    = xqsim(p);
\end_layout

\begin_layout Plain Layout

xgraph(d,cp);
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename xQSim_exp_rand_p1.eps
	width 50text%

\end_inset


\begin_inset Graphics
	filename xQSim_exp_rand_p2.eps
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Example: Normalized difference of theory versus experiment of two-dimensional
 binning from two separate random permutations.
 Left graph is a one-dimensional slice of the full distribution with statistical
 test outputs of 
\begin_inset Formula $\chi^{2}/k\approx28$
\end_inset

 for 
\begin_inset Formula $k=973$
\end_inset

 and 
\begin_inset Formula $Z\approx134$
\end_inset

.
 Right graph is also a one-dimensional slice of the full distribution with
 a different random permutation applied.
 Statistical test outputs are 
\begin_inset Formula $\chi^{2}/k\approx47$
\end_inset

 for 
\begin_inset Formula $k=976$
\end_inset

 and 
\begin_inset Formula $Z\approx173$
\end_inset

 for this permutation.
 Both simulations were performed for 
\begin_inset Formula $1.2\times10^{6}$
\end_inset

 ensembles.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
xQSim reference 
\begin_inset CommandInset label
LatexCommand label
name "sec:xqSIM-reference"

\end_inset


\end_layout

\begin_layout Standard

\series bold
\emph on
This section gives a reference guide to the xQSim parameters and functions.
\end_layout

\begin_layout Subsection
Included programs
\end_layout

\begin_layout Standard
The package provided has six parts:
\end_layout

\begin_layout Enumerate

\series bold
xQSimCode.
 
\series default
This contains all the main quantum simulation codes, from observable and
 comparison functions to quantum phase-space sample generating functions.
 
\end_layout

\begin_layout Enumerate

\series bold
xQSimExamples.
 
\series default
This has the scripts used to simulate experiments for comparisons, as well
 as scripts used for testing.
\end_layout

\begin_layout Enumerate

\series bold
xQSimData.
 
\series default
This has scripts used for simulating data from recent Gaussian boson sampling
 experiments.
\end_layout

\begin_layout Enumerate

\series bold
xQSimDocumentation.
 
\series default
This provides the documentation, including this report and a separate manual
 for the graphics program 
\shape italic
xGraph
\shape default
.
\end_layout

\begin_layout Enumerate

\series bold
xGraph.
 
\series default
This contains a multidimensional graphics program which is also used in
 the stochastic differential equation software package 
\shape italic
xSPDE
\shape default
.
 
\end_layout

\begin_layout Enumerate

\series bold
xQSimGBSExperiments.
 
\series default
This has recent public experimental data from Refs.
 
\begin_inset CommandInset citation
LatexCommand cite
key "zhong2020quantum,Zhong2021Phase"
literal "false"

\end_inset

, and data extraction codes for reference purposes.
\end_layout

\begin_layout Subsection
xQSim function call
\end_layout

\begin_layout Standard
The simulation function takes an input of parameter structures that define
 a sequence of networks.
 Each network in the sequence can be repeated, with recycling of the amplitudes,
 which are then combined with new squeezed or coherent inputs.
 Any input parameters or functions that are omitted are given appropriate
 default values.
\end_layout

\begin_layout Standard
Simulations carried out by the code are performed by other specialized internal
 functions.
 Input parameters come from an 
\series bold
input
\series default
 cell array of structures, while output is saved in a 
\series bold
data
\series default
 array, and optionally in a file.
 During the simulation, global averages and error-bars are calculated for
 sampling errors.
 When completed, timing and errors are printed.
\end_layout

\begin_layout Standard
The 
\emph on
xQSim
\emph default
 function call syntax is: 
\emph on
[error,data,output] = xQSim(input);
\end_layout

\begin_layout Standard
The input data includes parameters and methods, but with an open architecture
 for extensibility.
 Most functions are modular and replaceable.
 This is as easy as defining a new function handle to replace the default
 value.
 The code folder includes examples of how these are written.
 All output observables are divided up into a cell array of data graphs,
 generated in parallel.
\end_layout

\begin_layout Standard
To explain this in full detail, 
\end_layout

\begin_layout Itemize
Simulation parameters are stored in the 
\series bold
\emph on
input
\series default
\emph default
 cell array.
 
\end_layout

\begin_layout Itemize
This describes a sequence of parameter structures, so that 
\series bold
\emph on
input={p1,p2,...}
\series default
\emph default
.
 
\end_layout

\begin_layout Itemize
Each structure 
\series bold
\emph on
p1,p2,..
\emph default
.

\series default
 generates an output which is the input of the next.
 
\end_layout

\begin_layout Itemize
The main simulation function is called using 
\series bold
\emph on
xQSim(input).

\series default
\emph default
 
\end_layout

\begin_layout Itemize
The errors and integration time are returned in the 
\series bold
\emph on
error
\emph default
 
\series default
vector 
\end_layout

\begin_layout Itemize
Averages are recorded sequentially in the 
\series bold
\emph on
data
\series default
\emph default
 cell array.
 
\end_layout

\begin_layout Itemize
Parameters including defaults are returned in the 
\series bold
\emph on
output
\series default
\emph default
 cell array.
 
\end_layout

\begin_layout Standard
The sequence 
\emph on
input
\emph default
 defines a sequence of individual simulations, with parameters that specify
 the simulation functions and give the equations and observables.
 If there is only one simulation, just one data structure is needed, without
 a cell array.
 In addition, xQSim can generates graphs with a companion graphics program,
 xGraph.
\end_layout

\begin_layout Subsection
Parameters and functions
\end_layout

\begin_layout Standard
The xQSim input objects include parameters and functions.
 Many xQSim functions are modular and replaceable, through defining a new
 function handle to replace the default value.
\end_layout

\begin_layout Standard
There are standard conventions used throughout: 
\end_layout

\begin_layout Itemize
All arguments in square brackets are optional, but may be needed only in
 specific cases.
 
\end_layout

\begin_layout Itemize
The last argument, 
\emph on
p,
\emph default
 is the parameter structure.
 
\end_layout

\begin_layout Standard
The user-definable functions, input and output field dimensions and calling
 arguments are:
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arguments
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output dimensions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
a=qgen
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
(a,p): 
\begin_inset Formula $a=(2M\times S_{1})$
\end_inset

,
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

p=[struct]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $a=(2M\times S_{1})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
permute=xqpermutation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
~
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arbitrary: 
\begin_inset Formula $1\times M$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
o=observe{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
(a,p): 
\begin_inset Formula $a=(2M\times S_{1})$
\end_inset

,
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

p=[struct]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arbitrary: 
\begin_inset Formula $m_{1}\times m_{2}\ldots\times m_{n}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
c=compare{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
\begin_inset Formula $(p)$
\end_inset

,
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

p=[struct]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Match observe: 
\begin_inset Formula $m_{1}\times m_{2}\ldots\times m_{n}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
Notes 
\end_layout

\begin_layout Itemize

\series bold
\emph on
qgen
\emph default
 has a default, namely 
\begin_inset Formula $xqgen$
\end_inset

, which can be user modified
\end_layout

\begin_layout Itemize

\series bold
qgen input amplitudes are used for recycling.
 If this is not required, just use 
\begin_inset Formula $(\sim,p):$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
data outputs to xGraph include two extra dimensions, 
\begin_inset Formula $m_{l}\times m_{1}\times m_{2}\ldots\times m_{n}\times m_{e}$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
The first graphics 
\begin_inset Formula $m_{l}$
\end_inset

 dimension is reserved for plotting multiple lines on graphs
\end_layout

\begin_layout Itemize

\series bold
Obtaining multiple lines requires modifying the output data file before
 xGraph
\end_layout

\begin_layout Itemize

\series bold
The 
\begin_inset Formula $m_{e}$
\end_inset

 dimension is used for error bars.
 Here 
\begin_inset Formula $m_{e}=3$
\end_inset

 stores the sampling error bars
\end_layout

\begin_layout Subsection
Customization guide
\end_layout

\begin_layout Standard
To define your own stochastic generation function, include in the input
 the line:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
p.gen=@Mygen;
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Next, include anywhere on your Matlab path the function definition, for
 example:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function a = Mygen(a,p)
\end_layout

\begin_layout Plain Layout

\family typewriter
% a = Mygen(a,p) generates stochastic variables my way!
\end_layout

\begin_layout Plain Layout

\family typewriter
..
\end_layout

\begin_layout Plain Layout

\family typewriter
a = ...;
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

Similarly, to define your own observe function for (say) data graph 
\begin_inset Formula $6$
\end_inset

, include in the input the line:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
p.observe{6}=@Myobserve;
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Next, include anywhere on your Matlab path the function definition, for
 example:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function d = Myobserve(a,p)
\end_layout

\begin_layout Plain Layout

\family typewriter
% d = Myobserve(a,p) generates observables my way!
\end_layout

\begin_layout Plain Layout

\family typewriter
..
\end_layout

\begin_layout Plain Layout

\family typewriter
d = ...;
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

To define your own comparison function for the same graph, include in the
 input the line:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
p.compare{6} = @Mycompare;
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Next, include anywhere on your Matlab path the compare definition, for example:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
function c = Mycompare(a,p)
\end_layout

\begin_layout Plain Layout

\family typewriter
% c = Mycompare(a,p) generates comparisons my way!
\end_layout

\begin_layout Plain Layout

\family typewriter
..
\end_layout

\begin_layout Plain Layout

\family typewriter
c = ...;
\end_layout

\begin_layout Plain Layout

\family typewriter
end
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Hints
\end_layout

\begin_layout Itemize
When using xQSim, it is a good idea to first run the batch test script,
 xQSimtest.m.
 
\end_layout

\begin_layout Itemize
xQSimtest.m tests your parallel toolbox installation.
 If you have no license for this, omit the third ensemble setting.
\end_layout

\begin_layout Itemize
To create a script, it is often easiest to start with an existing script
 with similar requirements: see Examples folder.
\end_layout

\begin_layout Itemize
Graphics parameters can also be included in the parameter structure 
\begin_inset Formula $\mathbf{p}$
\end_inset

, either before or after calling 
\begin_inset Formula $qcpsim$
\end_inset

, to modify graphs.
\end_layout

\begin_layout Itemize
Comparison functions can be included to compare with analytic or experimental
 results.
\end_layout

\begin_layout Itemize
A full list of functionality is listed below.
\end_layout

\begin_layout Standard
The input data, here labeled 
\begin_inset Formula $input$
\end_inset

, is a sequence of parameter structures that are labeled 
\begin_inset Formula $p$
\end_inset

.
 All of the input parameters and data are later passed to the 
\begin_inset Formula $xgraph$
\end_inset

 function.
 The input data can be numbers, vectors, strings, functions and cell arrays.
 These are lists of data enclosed in curly brackets, 
\begin_inset Formula $\{\}$
\end_inset

.
 All xQSim metadata has preferred values, so only changes from the preferences
 need to be input.
 The resulting combined input including preferred values, is stored internally
 as a sequence of structures in a cell array to describe the simulation
 sequence.
\end_layout

\begin_layout Standard
Simulation metadata, including all preferred default values that were used
 in a particular simulation, is also stored in the xQSim output files.
 This is done in the Matlab 
\begin_inset Formula $.mat$
\end_inset

 format, for simplicity so the entire simulation can be easily reconstructed
 or changed.
 
\end_layout

\begin_layout Standard
Some conventions are used to simplify inputs, as follows: 
\end_layout

\begin_layout Itemize

\series bold
Most input data has default values
\end_layout

\begin_layout Itemize

\series bold
Vector inputs of numbers are enclosed in square brackets, [...].
 
\end_layout

\begin_layout Itemize

\series bold
Where multiple inputs of strings, functions or vectors are needed they should
 be enclosed in curly brackets, {...}, to create a cell array.
 
\end_layout

\begin_layout Itemize

\series bold
Vector or cell array inputs with only one member don't require brackets.
 
\end_layout

\begin_layout Itemize

\series bold
Incomplete vector or array inputs are completed with the last default or
 input value.
\end_layout

\begin_layout Itemize

\series bold
Default parameters are checked by inspecting the outputs, or setting verbose
 = 2.
\end_layout

\begin_layout Standard
In the output data arrays, the last index has 
\begin_inset Formula $m_{e}=1$
\end_inset

 for the averages.
 The first error field, 
\begin_inset Formula $m_{e}=2$
\end_inset

, is reserved for any systematic errors like step-sizes.
 The last error field, 
\begin_inset Formula $m_{e}=3$
\end_inset

 is used for storing one standard deviation error-bar estimates due to computati
onal sampling errors.
\end_layout

\begin_layout Subsection
Parameter table
\begin_inset CommandInset label
LatexCommand label
name "sec:Simulation-parameters"

\end_inset


\end_layout

\begin_layout Standard
Simulation parameters are stored in a parameter structure which is passed
 to the 
\begin_inset Formula $xsim$
\end_inset

 program.
 Inputs have default values, which are user-modifiable through the
\emph on
 xpreferences
\emph default
 function.
 Defaults can be checked by including the input 
\begin_inset Formula $verbose=2$
\end_inset


\emph on
.

\emph default
 All the inputs are part of a structure passed to xQSim.
 If a cell array of multiple structures are input, these are executed in
 sequence, with the output of the first simulation passed to the second,
 then the third, and so on.
\end_layout

\begin_layout Standard
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="26" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
deco
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
string
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
''
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Decoherence factors used for optimization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
bits
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
None
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of bits used for data extraction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CO
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
None
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Correlation order
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
compare
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function handles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Optional comparison functions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
counts
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total experimental counts for 
\begin_inset Formula $\chi^{2}$
\end_inset

 tests
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
cutoff
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
real
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-1.e100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lower cutoff for graphs and 
\begin_inset Formula $\chi^{2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
cyc
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of cycles of the network
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
ensembles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[1,1,1]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Size of vector, serial, parallel ensemble
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
eps
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An n-dimensional decoherence factor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
M
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total matrix size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
matrix
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
matrix function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Identity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An 
\begin_inset Formula $M\times M$
\end_inset

 transfer matrix function
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
method
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Phase-space method: 
\begin_inset Formula $m=1,2,3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
mincount
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimum count for 
\begin_inset Formula $\chi^{2}$
\end_inset

 tests
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of excited input modes
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
character
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
''
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Name of simulation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
O
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
None
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vector of various correlation orders
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
observe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function handles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\{@(a,p)\,a\}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable functions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
permute
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[1,2,3,\dots,M]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random permutation of outputs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
pnames
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
array of characters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
{'+P ','W ','Q '}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Names of phase-space methods
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
qgen
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function handle
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $@xqgen$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stochastic generation code
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector or function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An n-dimensional squeezing vector
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
re
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An n-dimensional recycling factor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An n-dimensional transmission factor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Tname
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
unitary name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
matrix(0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Name of transmission matrix
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
verbose
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag for printing verbosity level: 0,1,2
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Parameter reference
\end_layout

\begin_layout Standard
The following parameters can be applied to each member of the simulation
 sequence.
 For single-input, single-pass GBS experiments, they are only specified
 once.
\end_layout

\begin_layout Subsubsection
bits
\end_layout

\begin_layout Description
Default: None
\end_layout

\begin_layout Standard
Integer used to define the bit-type encoding of experimental binary data
 files.
 Only used for integrated data extraction codes.
 
\end_layout

\begin_layout Itemize
p.bits 
\end_layout

\begin_layout Subsubsection
compare
\end_layout

\begin_layout Description
Default: []
\end_layout

\begin_layout Standard
Cell array of function handles to generate the comparison data.
 A large number of functions equivalent to common hermitian operators are
 available for analytically known cases..
\end_layout

\begin_layout Itemize
p.compare = {@function,..}
\end_layout

\begin_layout Subsubsection
CO
\end_layout

\begin_layout Description
Default: None
\end_layout

\begin_layout Standard
Used to define the correlation order for calculating click correlation moments
 or marginal probabilities of output distribution.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $p.CO$
\end_inset


\end_layout

\begin_layout Subsubsection
counts
\end_layout

\begin_layout Description
Default: 0
\end_layout

\begin_layout Standard
Used to define the total counts for calculating count numbers and minimum
 count cutoffs when there is experimental data on experimental count probabiliti
es.
\end_layout

\begin_layout Itemize
\begin_inset Formula $p.counts>0$
\end_inset


\end_layout

\begin_layout Subsubsection
cutoff
\end_layout

\begin_layout Description
Default: -1E-100
\end_layout

\begin_layout Standard
Used to define a lower cutoff, especially for probability data, where a
 small positive value, e.g.
 
\begin_inset Formula $10^{-7}$
\end_inset

, should be used.
 This is useful for log graphs and 
\begin_inset Formula $\chi^{2}$
\end_inset

 fits.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $p.cutoff$
\end_inset


\end_layout

\begin_layout Subsubsection
cyc
\end_layout

\begin_layout Description
Default: 1
\end_layout

\begin_layout Standard
Number of cycles of the network simulated.
\end_layout

\begin_layout Itemize
p.cyc >0
\end_layout

\begin_layout Subsubsection
deco
\end_layout

\begin_layout Description
Default: ' '
\end_layout

\begin_layout Standard
String used to output deocherence factors 
\begin_inset Formula $eps$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 during optimization.
 Only needs to be used if Matlabs 
\shape italic
fminsearch
\shape default
 is performing optimization.
 
\end_layout

\begin_layout Itemize
p.deco 
\end_layout

\begin_layout Subsubsection
ensembles
\end_layout

\begin_layout Description
Default: [1,1,1]
\end_layout

\begin_layout Standard
Number of ensembles used in simulations.
 The first is the local vector ensemble.
 The second is the number of serial repeats.
 The third is the number or parallel repeats.
 Note that serial and parallel repeats are used for sampling error estimation.
\end_layout

\begin_layout Itemize
p.name = [ens1,ens2,ens3]
\end_layout

\begin_layout Subsubsection
eps
\end_layout

\begin_layout Description
Default: 0
\end_layout

\begin_layout Standard
This gives a real decoherence vector that is input.
 It is expected to be of length at least 
\begin_inset Formula $p.N$
\end_inset

.
 If smaller, it will be expanded to length 
\begin_inset Formula $p.N$
\end_inset

.
 The values should such that 
\begin_inset Formula $0\le p.eps\le1$
\end_inset

.
\end_layout

\begin_layout Itemize
p.eps 
\end_layout

\begin_layout Subsubsection
M
\end_layout

\begin_layout Description
Default: 1
\end_layout

\begin_layout Standard
Total number of input and/or output modes to the network.
\end_layout

\begin_layout Itemize
p.M >0
\end_layout

\begin_layout Subsubsection
matrix
\end_layout

\begin_layout Description
Default: @Identity
\end_layout

\begin_layout Standard
Function handle to generate the linear network matrix.
 Both Identity and random Unitary matrices are supplied.
 It can also be just an 
\begin_inset Formula $M\times M$
\end_inset

 complex matrix, for small test matrices entered inline.
\end_layout

\begin_layout Itemize
p.matrix = @function
\end_layout

\begin_layout Subsubsection
method
\end_layout

\begin_layout Description
Default: 1
\end_layout

\begin_layout Standard
The phase-space method, where 1 = generalized P-representation, 2 = Wigner
 representation, 3 = Husimi (Q) representation
\end_layout

\begin_layout Itemize
p.method > 0
\end_layout

\begin_layout Subsubsection
mincount
\end_layout

\begin_layout Description
Default: 0
\end_layout

\begin_layout Standard
Used to set a lower bound on calculations for chi-square fits, when there
 is experimental data on experimental count probabilities.
 A typical value here is 
\begin_inset Formula $10$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $p.mincount>0$
\end_inset


\end_layout

\begin_layout Subsubsection
N
\end_layout

\begin_layout Description
Default: 1
\end_layout

\begin_layout Standard
Number of input modes excited, less than or equal 
\begin_inset Formula $M$
\end_inset


\end_layout

\begin_layout Itemize
p.N >0
\end_layout

\begin_layout Itemize
p.M >0
\end_layout

\begin_layout Subsubsection
name
\end_layout

\begin_layout Description
Default: ' '
\end_layout

\begin_layout Standard
Name used to label simulation, usually corresponding to the equation or
 problem solved, and will be passed to the xGraph program if it is used.
\end_layout

\begin_layout Itemize
p.name = 'your project name'
\end_layout

\begin_layout Subsubsection
O
\end_layout

\begin_layout Description
Default: None
\end_layout

\begin_layout Standard
Used to define a vector of correlation orders to simulate mean click or
 photon number correlations over adjacent channels.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $p.O$
\end_inset


\end_layout

\begin_layout Subsubsection
observe
\end_layout

\begin_layout Description
Default: {@(a,p) mean(real(a),2)}
\end_layout

\begin_layout Standard
Cell array of function handles to generate the observable phase-space averages.
 A large number of functions equivalent to commonly used hermitian operators
 are available.
\end_layout

\begin_layout Itemize
p.observe = {@function,..}
\end_layout

\begin_layout Subsubsection
permute
\end_layout

\begin_layout Description
Default: 
\begin_inset Formula $[1,2,3,\dots,M]$
\end_inset


\end_layout

\begin_layout Standard
Random permutation vector of size 
\begin_inset Formula $1\times M$
\end_inset

 obtained either manually or via a data extraction output which is applied
 to rows of the transmission matrix for phase-space simulations.
 
\end_layout

\begin_layout Itemize
p.permute = xqpermutation
\end_layout

\begin_layout Subsubsection
pnames
\end_layout

\begin_layout Description
Default: {’+P ’,’W ’,’Q ’}
\end_layout

\begin_layout Standard
Cell vector of names used to label the phase-space representation, to allow
 future expansion or changes.
 Normally is not changed from default and can be omitted.
\end_layout

\begin_layout Itemize
p.pnames = {'your favorite method'}
\end_layout

\begin_layout Subsubsection
qgen
\end_layout

\begin_layout Description
Default: @qgen
\end_layout

\begin_layout Standard
Name of network quantum noise function.
 The default qgen function is used for GBS, and in this case, just omit
 
\begin_inset Formula $qgen$
\end_inset

.
\end_layout

\begin_layout Itemize
p.qgen = @yourgenerator
\end_layout

\begin_layout Subsubsection
r
\end_layout

\begin_layout Description
Default: 0
\end_layout

\begin_layout Standard
This gives a real squeezing vector that is input.
 It is expected to be of length at least 
\begin_inset Formula $p.N$
\end_inset

.
 If smaller, it will be expanded to length 
\begin_inset Formula $p.N$
\end_inset

.
 The entries with index greater than 
\begin_inset Formula $p.N$
\end_inset

 are set to zero.
 Can be replaced by a function call for large quantities of data.
\end_layout

\begin_layout Itemize
p.r 
\end_layout

\begin_layout Subsubsection
re
\end_layout

\begin_layout Description
Default: 0
\end_layout

\begin_layout Standard
This gives a real recycling amplitude.
 It is expected to be of length 
\begin_inset Formula $p.M$
\end_inset

.
 If smaller, it will be expanded to length 
\begin_inset Formula $p.M$
\end_inset

.
 The entries with index greater than 
\begin_inset Formula $p.M$
\end_inset

 are set to zero.
 This allows previous amplitudes to be recycled.
\end_layout

\begin_layout Itemize
\begin_inset Formula $p.re\le1$
\end_inset

 
\end_layout

\begin_layout Subsubsection
t
\end_layout

\begin_layout Description
Default: 1
\end_layout

\begin_layout Standard
This gives a real transmission vector that is input.
 It is expected to be of length 
\begin_inset Formula $p.M$
\end_inset

.
 If smaller, it will be expanded to length 
\begin_inset Formula $p.M$
\end_inset

.
 The entries with index greater than 
\begin_inset Formula $p.M$
\end_inset

 are set to zero.
 This allows corrections to be made to the measured transmission matrix.
\end_layout

\begin_layout Itemize
\begin_inset Formula $p.t\le1$
\end_inset

 
\end_layout

\begin_layout Subsubsection
Tname
\end_layout

\begin_layout Description
Default: matrix(0)
\end_layout

\begin_layout Standard
Name used to label type of network matrix.
 Usually it is returned by the matrix function to give the default name.
 However, other matrix names can be entered here.
\end_layout

\begin_layout Itemize
p.Tname = 'your transmission matrix name'
\end_layout

\begin_layout Subsubsection
verbose
\end_layout

\begin_layout Description
Default: 0
\end_layout

\begin_layout Standard
Print flag for output information while running xQSim.
 If ``verbose = 0``, most output is suppressed, while ``verbose = 1`` displays
 a progress report, and ``verbose = 2`` also generates a readable summary
 of the parameters as a record.
\end_layout

\begin_layout Itemize
p.verbose >= 0
\end_layout

\begin_layout Section
xGraph reference
\begin_inset CommandInset label
LatexCommand label
name "sec:xGRAPH-reference"

\end_inset


\end_layout

\begin_layout Standard
The graphics function provided is a general purpose multidimensional batch
 graphics code, xGraph, which can be called when xQSim is finished.
 The results are graphed and output if required.
 Alternatively, xGraph can be replaced by another graphics code, or it can
 be used to process the data generated by xQSim at a later time.
\end_layout

\begin_layout Standard
The program is described elsewhere, but the documentation is replicated
 here for users who wish to use it.
 The 
\emph on
xGraph
\emph default
 function call syntax is: 
\end_layout

\begin_layout Itemize

\series bold
\emph on
xgraph (data [,input])
\series default
\emph default
 
\end_layout

\begin_layout Standard
This takes simulation 
\emph on
data
\emph default
 and 
\emph on
input
\emph default
 cell arrays with graphics parameters, then plots graphs.
 The 
\emph on
data
\emph default
 should have as many cells as there are 
\emph on
input
\emph default
 cells, for sequences.
 The data can include comparisons, either analytic or experimental, and
 error-bars for both the simulations and the comparisons, since either may
 have sampling or other errors.
\end_layout

\begin_layout Standard
If 
\emph on
data = 'filename.h5'
\emph default
 or
\emph on
 'filename.mat'
\emph default
, the specified file is read both for 
\emph on
input
\emph default
 and 
\emph on
data
\emph default
.
 Here 
\emph on
.h5
\emph default
 indicates an HDF5 file, and 
\emph on
.mat
\emph default
 indicates a Matlab file.
\end_layout

\begin_layout Standard
When the 
\emph on
data
\emph default
 input is a filename, parameters in the file can be replaced by new 
\emph on
input
\emph default
 parameters that are specified.
 Any stored 
\emph on
input
\emph default
 parameters in the file are overwritten when graphs are generated.
 This allows graphs of data to be modified retrospectively, if the simulation
 takes too long to be run again in a reasonable timeframe.
\end_layout

\begin_layout Subsection
Parameter and data structures
\end_layout

\begin_layout Standard
This is a batch graphics function, intended to process quantities of graphics
 data in sequence, input as a cell array of multi-dimensional data.
 Theoretical and/or experimental data is passed to the graphics program,
 including the complete 
\emph on
data
\emph default
 cell array and a cell array of graphics parameters for plotting each graph.
 For a sequence of one member, the enclosing cell array can be omitted.
\end_layout

\begin_layout Standard
To explain xGraph in full detail, 
\end_layout

\begin_layout Itemize
Data to be graphed are recorded sequentially in a cell array, with 
\emph on
data={d1,d2,...}
\emph default
.
\end_layout

\begin_layout Itemize
Graphics parameters including defaults are given in the 
\emph on
input
\emph default
 cell array.
 
\end_layout

\begin_layout Itemize
This describes a sequence of graph parameters, so that 
\emph on
input={p1,p2,...}
\emph default
.
 
\end_layout

\begin_layout Itemize
For a one member sequence, a dataset and parameter structure can be used
 on its own.
 
\end_layout

\begin_layout Itemize
Each dataset and parameter structure describes a set of graphs.
 
\end_layout

\begin_layout Standard
The data input to 
\emph on
xGraph 
\emph default
can either come from a file, or from data generated directly with 
\emph on
x
\emph default
QSim.
 The main graphics data is a nested cell array.
 It contains several numerical graphics arrays.
 Each defines one independent set of averaged data, the observed data averages,
 stored in a cell array indexed as 
\begin_inset Formula $data\{s\}\{n\}(\ell,\mathbf{j},c)$
\end_inset

.
 To graph these also requires a corresponding cell array of structures of
 graphics parameters.
\end_layout

\begin_layout Standard
The output is unlimited, apart from memory limits.
 The program also generates error comparisons and chi-squared values if
 required.
 The data structure for input is as follows: 
\end_layout

\begin_layout Enumerate
The
\emph on
 input
\emph default
 is a cell array of parameter structures, which can be collapsed to one
 structure 
\end_layout

\begin_layout Enumerate
The input 
\emph on
data
\emph default
 is a cell array of 
\emph on
datasets, 
\emph default
which can be collapsed to a single dataset 
\end_layout

\begin_layout Enumerate
Each 
\emph on
dataset 
\emph default
is a cell array of multidimensional 
\emph on
graphs
\emph default
, with arbitrary dimensionality.
 
\end_layout

\begin_layout Enumerate
The first or 
\emph on
line
\emph default
 index of each graph array allows multiple lines, with different line-styles
 
\end_layout

\begin_layout Enumerate
The last or 
\emph on
check
\emph default
 index of each graph array is optionally used for error and comparison fields.
 
\end_layout

\begin_layout Enumerate
Each 
\emph on
graph
\emph default
 array can generate multiple graphic plots, as defined by the parameters.
 
\end_layout

\begin_layout Subsubsection
Comparisons
\end_layout

\begin_layout Standard
For every type of observation, the observe function can be accompanied by
 a comparison function, 
\emph on
compare(p)
\emph default
.
 This generates a vector of analytic solutions or experimental data which
 is compared to the stochastic results.
 Results are plotted as additional lines on the two-dimensional graphical
 outputs, and comparison differences can be graphed in any dimension.
\end_layout

\begin_layout Standard
Comparisons are possible for either moments or probabilities, and can be
 input in any number of dimensions.
 When there are error estimates, a chi-squared test is carried out to determine
 if the difference is within the expected step-size and sampling error bars.
 If the comparison has errors, for example from experimental data, the chi-squar
ed test will include the experimental errors.
\end_layout

\begin_layout Standard
Comparison data can be added to the graphics files from any source.
 It must match the corresponding space-time lattice or probability bins
 that are in the graphed data.
 Note that the 
\emph on
compare 
\emph default
functions are specified during the simulation.
 The graphics code does not generate comparison data, as it is dedicated
 to graphics, not to generating data.
\end_layout

\begin_layout Subsection
Parameter table
\begin_inset CommandInset label
LatexCommand label
name "sec:Graphics-parameter-table"

\end_inset


\end_layout

\begin_layout Standard
The complete cell array of the simulation data is passed to the 
\emph on
xGraph
\emph default
 program, along with graphics parameters for each observable, to create
 an extended graphics data structure.
 Graphics parameters have default values which are user-modifiable by editing
 the
\emph on
 xgpreferences
\emph default
 function.
\end_layout

\begin_layout Standard
Some input parameters are global parameters for all graphs.
 However, most 
\emph on
xGraph
\emph default
 parameters are cell arrays indexed by graph index.
 These graphics parameters are individually set for each output that is
 plotted, using the cell index 
\begin_inset Formula $\{n\}$
\end_inset

 in a curly bracket.
 If present they replace the global parameters like labels.
 
\end_layout

\begin_layout Standard
If a graph index is omitted, and the parameter is not a nested array, the
 program will use the same value for all graphs.
 The 
\emph on
axes
\emph default
, 
\emph on
glabels, legends, lines, logs, 
\emph default
and
\emph on
 xfunctions
\emph default
 of each graph are nested cell arrays, as there can be any number of lines
 and axis dimensions.
 In the case of the 
\emph on
logs
\emph default
 switch, the observable axis is treated as an extra dimension.
\end_layout

\begin_layout Standard
The plotted result can be an arbitrary function of the generated average
 data, by using the optional input
\emph on
 gfunction.
 
\emph default
If this is omitted, the
\emph on
 
\emph default
generated average data that is input is plotted.
\end_layout

\begin_layout Standard
Comparisons are plotted if present in the input data indexed by the last
 or check index 
\begin_inset Formula $c$
\end_inset

, with 
\emph on

\begin_inset Formula $c>errors$
\end_inset


\emph default
, where 
\emph on

\begin_inset Formula $errors=3$
\end_inset


\emph default
 is the usual maximum value.
 
\end_layout

\begin_layout Standard
A table of the graphics parameters is given below.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="34" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Default value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
axes{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
{0,..}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Points plotted for each axis
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
chisqplot{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Chi-square plot options
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
cutoff
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.e-12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Global lower cutoff for chi-squares
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
cutoffs{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
cutoff
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Probability cutoff for n-th graph
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
diffplot{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Comparison difference plot options
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
errors
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Index of last error field in 
\emph on
data
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
esample{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Size and type of sampling error-bar
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
font{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Font size for graph labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
gfunction{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
@(d,~)
\begin_inset space ~
\end_inset

d{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Functions of graphics data
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
glabels{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{'t' ,'x' ,'y' ,'z'}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graph-specific axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
graphs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $[1:max]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vector of all the required graphs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
gsqplot{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
G-square (likelihood) plot options
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
headers{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Graph headers
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
images{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of movie images
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
imagetype{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type of 3D image
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
legends{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
{'label1',..}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Legends for multi-line graphs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
limits{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{[lc1,uc1],[lc2,uc2]}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Axis limits, first lower then upper
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
linestyle{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{'-',..}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Line styles for multiline 2D graphs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
linewidth{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Line width for 2D graphs (in points)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
logs{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
{0,..}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Axis logarithmic switch: 
\begin_inset Formula $0$
\end_inset

 linear, 
\begin_inset Formula $1$
\end_inset

 log
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
minbar{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimum relative error-bar
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
mincount
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Global counts for chi-square cutoffs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Global graph header
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
olabels{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
'a_1'
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observable labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
pdimension{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum plot dimensions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
saveeps
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Switch, set to 1 to save eps files
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
savefig
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Switch, set to 1 to save figure files
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
scale{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Scaling: Counts/ probability density
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transverse{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of transverse plots
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xfunctions{n}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{@(t,~) t,@(x,~) x,..}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Axis transformations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
verbose
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 for brief, 1 for informative, 2 for full output
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
xlabels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
{'t' ,'x' ,'y' ,'z'...}
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Global axis labels
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
octave
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 for Matlab, 1 for octave environment
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Itemize
There are up to 6 types of input data, with errors and comparisons, indexed
 by the last index.
 The original mean data always has 
\emph on
c =1
\emph default
.
 If there are no errors or comparisons, one graph is plotted for each dimensiona
l reduction.
 
\end_layout

\begin_layout Itemize
The data has up to two error bars (I and II), and optional comparisons with
 up to two error bars.
 
\end_layout

\begin_layout Itemize
Type I errors labeled 
\emph on

\begin_inset Formula $c=2$
\end_inset


\emph default
 have standard vertical error bars.
 Type II errors labeled 
\emph on

\begin_inset Formula $c=3$
\end_inset


\emph default
, which are usually standard deviation errors from sampling, have two solid
 lines.
 
\end_layout

\begin_layout Itemize
If 
\emph on
esample
\emph default
 = -1
\emph on
,
\emph default
 the error bars are combined and the RMS errors are plotted as a single
 error bar.
 
\end_layout

\begin_layout Itemize
If 
\emph on

\begin_inset Formula $diffplot>0$
\end_inset

, 
\emph default
differences are plotted as unnormalized (
\emph on

\begin_inset Formula $diffplot=1$
\end_inset

)
\emph default
, or normalized
\emph on
 
\emph default
(
\emph on

\begin_inset Formula $diffplot=2$
\end_inset

) 
\emph default
by the total RMS errors.
 If 
\begin_inset Formula $diffplot=3$
\end_inset

, raw comparison data is plotted.
 
\end_layout

\begin_layout Itemize
When differences are plotted, the total comparison errors have type I error
 bars while total simulation errors have type II errors with parallel lines,
 in order to distinguish them.
 
\end_layout

\begin_layout Standard
A detailed description of each parameter is listed in Sec (
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Parameter-reference"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Subsection
Example
\end_layout

\begin_layout Standard
A simple example of data and input parameters, but without errors or comparisons
 is as follows 
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Doublebox
position "t"
hor_pos "l"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "75col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\family typewriter
p.name = 'Sine and cosine functions';
\end_layout

\begin_layout Plain Layout

\family typewriter
p.olabels = {'sine(m_1/100)','cosine(m_1/100)'};
\end_layout

\begin_layout Plain Layout

\family typewriter
data = {sin([1:100*pi]/100),cos([1:100*pi]/100)};
\end_layout

\begin_layout Plain Layout

\family typewriter
xgraph(data,p);
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename xGraphfig1.eps
	width 50text%

\end_inset


\begin_inset Graphics
	filename xGraphfig2.eps
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Example: xGraph output of two plots
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that in this case the default setting of 
\emph on
p.errors=0 
\emph default
is used, with no check index used in the data arrays, because these are
 simple graphs without error-bars or comparisons.
\end_layout

\begin_layout Subsection
xGraph data arrays
\end_layout

\begin_layout Standard
The data input to 
\emph on
xGraph 
\emph default
can come from a file, or from data generated directly from any compatible
 program.
\end_layout

\begin_layout Standard
The data is stored in a cell array 
\begin_inset Formula $data$
\end_inset

 with structure: 
\begin_inset Formula 
\[
data\{s\}\{n\}(\ell,\mathbf{j},c)
\]

\end_inset

Each member of the outer cell array 
\emph on
data{s}
\emph default
 defines a number of related sets of graphical data, all described by common
 parameters 
\emph on
input{s}
\emph default
.
 Comparisons and errors are plotted if there are errors and comparison data
 in the input, indexed by 
\emph on
c
\emph default
.
 This generates comparison plots, as well as error totals and 
\begin_inset Formula $\chi$
\end_inset

- squared error estimate when there are statistical variances available.
\end_layout

\begin_layout Standard
An individual member of 
\emph on
data{s}{n}
\emph default
 is a multidimensional array, called a 
\emph on
graph
\emph default
 in the xSPDE User's guide.
 For each 
\emph on
graph
\emph default
, multiple different plots with different dimensionality can be obtained
 from the dataset 
\emph on
data{s}{n}
\emph default
, either through projections and slices or by generating additional data
 defined with graphics functions.
 Either or both alternatives are available.
\end_layout

\begin_layout Standard
Note that: 
\end_layout

\begin_layout Itemize
If a sequence has one member, the outer cell array can be omitted.
 
\end_layout

\begin_layout Itemize
In this simplified case, if there is only one 
\emph on
graph
\emph default
 array, the inner cell array can be omitted.
 
\end_layout

\begin_layout Standard
The graphics data for a single dataset is held in a multidimensional real
 array, where: 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\ell$
\end_inset

 is the index for lines in the graph.
 Even for one line, the first dimension is retained.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{j}=j_{1},\ldots j_{d}$
\end_inset

 is the array index in each dimension, where 
\begin_inset Formula $d\ge1$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Averages in momentum space have the momentum origin as the central index.
 
\end_layout

\begin_layout Itemize
If integrals or spatial averages are used, the corresponding dimension has
 one index 
\begin_inset Formula $j_{d}=1$
\end_inset

.
 
\end_layout

\begin_layout Itemize
With probabilities, extra dimensions are added to 
\begin_inset Formula $\mathbf{j}$
\end_inset

 to store the bin indices.
 
\end_layout

\begin_layout Itemize

\emph on
c
\emph default
 indexes error-checks and comparisons.
 If not present, omit 
\emph on
p.errors
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 and
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 the last dimension.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $c>p.errors$
\end_inset

, the extra fields are comparison inputs, where 
\begin_inset Formula $p.errors$
\end_inset

 is the largest data index.
 
\end_layout

\begin_layout Standard
When the optional comparison fields are used, an input parameter 
\begin_inset Formula $errors$
\end_inset

 is required to indicate the maximum error index, to distinguish data from
 comparisons.
 Parameter structures from xSIM have 
\begin_inset Formula $errors=3$
\end_inset

 set to allow for both sampling errors and discretization errors.
 If this is omitted, the default is 
\begin_inset Formula $errors=0$
\end_inset

, which implies that there is no error or comparison data
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $errors>0$
\end_inset

, the last index can have larger values with 
\begin_inset Formula $c>errors$
\end_inset

, for comparisons.
 The special case of 
\begin_inset Formula $errors=1$
\end_inset

 is used if the data has no error bars, but there are comparisons in the
 data.
 Larger indices are used to index the comparison data, which can also have
 two types of errors.
 The largest usable last index is 
\begin_inset Formula $errors+3$
\end_inset

.
\end_layout

\begin_layout Standard
It is possible to directly plot the 
\emph on
raw 
\emph default
data using xGraph.
 One can even combine the raw data with a graphics parameter input.
 But since the raw data has no error estimates - it is raw data - one must
 set 
\begin_inset Formula $p.errors=0$
\end_inset

, since the xsim output parameters have a normal setting of 
\begin_inset Formula $p.errors=3$
\end_inset

.
 This will give a single trajectory.
\end_layout

\begin_layout Standard
However, the raw data from a simulation typically includes many trajectories
 if
\emph on
 
\begin_inset Formula $ensembles(1)>0$
\end_inset


\emph default
.
 One must select particular trajectory datasets from the raw cell array,
 to plot just one.
\end_layout

\begin_layout Subsection
Input parameters and defaults
\end_layout

\begin_layout Standard
A sequence of graph parameters is obtained from inputs in a cell array,
 as 
\emph on
input = {in1, in2, ...}
\emph default
.
 The input parameters of each simulation in the sequence are specified in
 a Matlab structure.
 The inputs are numbers, vectors, strings, functions and cell arrays.
 All metadata has preferred values, so only changes from the preferences
 need to be input.
 The resulting data is stored internally as a sequence of structures in
 a cell array, to describe the simulation sequence.
\end_layout

\begin_layout Standard
The graphics parameters are also stored in the cell array 
\emph on
input
\emph default
 as a sequence of structures 
\emph on
p.

\emph default
 This only need to be input when the graphs are generated and can be changed
 at a later time to alter the graphics output.
 A sequence of simulations is graphed from 
\emph on
input
\emph default
 specifications.
\end_layout

\begin_layout Standard
If there is one simulation, just one structure can be input, without the
 sequence braces.
 The standard way to input each parameter value is:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
p.label=parameter
\]

\end_inset


\end_layout

\begin_layout Standard
The standard way to input a function handle is:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
p.label=@function
\]

\end_inset


\end_layout

\begin_layout Standard
The inputs are scalar or vector parameters or function handles.
 Quantities relating to graphed averages are cell arrays, indexed by the
 graph number.
 The available inputs, with their default values in brackets, are given
 below.
\end_layout

\begin_layout Standard
Simulation metadata, including default values that were used in a particular
 simulation, can be included in the input data files.
 This is done in both the 
\emph on
.mat
\emph default
 and the 
\emph on
.h5
\emph default
 output files generated by xSIM, so the entire graphics input can be reconstruct
ed or changed.
\end_layout

\begin_layout Standard
Parameters can be numbers, vectors, strings or cell arrays.
 Conventions that are used are that: 
\end_layout

\begin_layout Itemize
All input parameters have default values 
\end_layout

\begin_layout Itemize
Vector inputs of numbers are enclosed in square brackets, 
\emph on
[...]
\emph default
.
 
\end_layout

\begin_layout Itemize
Cell arrays of strings, functions or vectors are enclosed in curly brackets.
 
\end_layout

\begin_layout Itemize
Vector or cell array inputs with only one member don’t require brackets.
 
\end_layout

\begin_layout Itemize
Incomplete parameter inputs are completed with the last used default value.
 
\end_layout

\begin_layout Itemize
Function definitions can be handles pointing elsewhere, or defined inline.
 
\end_layout

\begin_layout Standard
If any inputs are omitted, there are default values which are set by the
 internal function
\emph on
 xgpreferences
\emph default
.
 The defaults can be changed by editing 
\emph on
xgpreferences
\emph default
.
\end_layout

\begin_layout Standard
In the following descriptions, 
\emph on
graphs
\emph default
 is the total number of graphed variables of all types.
 The space coordinate, image, image-type and transverse data can be omitted
 if there is no spatial lattice, that is, if the dimension variable is set
 to one.
\end_layout

\begin_layout Standard
For uniformity, the graphics parameters that reference an individual data
 object are cell arrays.
 These are indexed over the graph number using braces 
\emph on
{}
\emph default
.
 If a different type of input is used, like a scalar or matrix, xSPDE will
 attempt to convert the type to a cell array.
\end_layout

\begin_layout Standard
Axis labels are cell arrays, indexed over dimension.
 The graph number used to index these cell arrays refers to the data object.
 In each case there can be multiple generated plots, depending on the graphics
 input.
\end_layout

\begin_layout Subsection
Cascaded plots
\end_layout

\begin_layout Standard
The xGraph function generates a default range of graphs, but this can be
 modified to suit the user.
 In the simplest case of one dimension, one graph dataset will generate
 a single plot.
 For higher dimensions, a cascade of plots is generated to allow visualization,
 starting from 3D movies, then 3D static plots and finally 2D slices.
 These can also be user modified.
 
\end_layout

\begin_layout Standard
Note that for all probabilities, the plot dimension is increased by the
 bin range dimensionality.
\end_layout

\begin_layout Subsubsection
Plot dimensions
\end_layout

\begin_layout Standard
The 
\emph on
pdimension
\emph default
 input sets the maximum plotted dimensions.
 For example, 
\begin_inset Formula $pdimension\{1\}=1$
\end_inset

 means that only plots vs 
\begin_inset Formula $r_{1}$
\end_inset

 are output for the first function plotted.
 Default values are used for the non-plotted dimensions, unless there are
 axes specified, as indicated below.
\end_layout

\begin_layout Standard
The graphs cascade down from higher to lower dimensions, generating different
 types of graphs.
 Each type of graph is generated once for each function index.
\end_layout

\begin_layout Subsubsection
Plot axes
\end_layout

\begin_layout Standard
The graphics axes that are used for plotting and the points plotted are
 defined using the optional 
\emph on
axes
\series bold
 
\series default
\emph default
input parameters, where 
\begin_inset Formula $axes\{n\}$
\end_inset

 indicates the 
\emph on
n
\emph default
-th specified graph or set of generated graph data.
\end_layout

\begin_layout Standard
If there are no 
\emph on
axes
\series bold
 
\series default
\emph default
inputs, or the 
\emph on
axes
\emph default
 inputs are zero - for example, 
\begin_inset Formula $axes\{1\}=\{0,0,0\}$
\end_inset

 - only the lowest dimensions are plotted, up to 
\emph on
3
\emph default
.
 If either the data or 
\emph on
axes
\series bold
 
\series default
\emph default
inputs project one point in a given dimension, - for example, 
\begin_inset Formula $axes\{1\}=\{0,31,-1,0\}$
\end_inset

, this dimension is suppressed in the plots, which reduces the effective
 dimension of the data - in this case to two dimensions.
\end_layout

\begin_layout Standard
Examples: 
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{1\}=\{0\}$
\end_inset

 - For function 1, plot all the first dimensional points; higher dimensions
 get defaults.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{2\}=\{-2,0\}$
\end_inset

 - For function 2, plot the maximum value of 
\begin_inset Formula $r_{1}$
\end_inset

 (the default) and all higher-dimensional x-points.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{3\}=\{1:4:51,32,64\}$
\end_inset

 - For function 3, plot every 4-th 
\begin_inset Formula $x_{1}$
\end_inset

 point at 
\begin_inset Formula $x_{2}$
\end_inset

 point 32, 
\begin_inset Formula $x_{3}$
\end_inset

 point 64 
\end_layout

\begin_layout Itemize
\begin_inset Formula $axes\{4\}=\{0,2:4:48,0\}$
\end_inset

 - For function 4, plot every 
\begin_inset Formula $x_{1}$
\end_inset

 point , every 4-th 
\begin_inset Formula $x_{2}$
\end_inset

 point, and all 
\begin_inset Formula $x_{3}$
\end_inset

-points.
 
\end_layout

\begin_layout Standard
Points labelled 
\begin_inset Formula $-1$
\end_inset

 indicates a default `typical' point, which is the midpoint.
 If one uses 
\begin_inset Formula $-2$
\end_inset

, this is the last point.
\end_layout

\begin_layout Standard
Lower dimensions are replaced by corresponding higher dimensions if there
 are 
\emph on
dimensions
\emph default
 or 
\emph on
axes
\emph default
 that are suppressed.
 Slices can be taken at any desired point, not just the midpoint.
 The notation of 
\begin_inset Formula $axes\{1\}=\{6:3:81\}$
\end_inset

, is used to modify the starting, interval, and finishing points for complete
 control on the plot points.
\end_layout

\begin_layout Standard
The graphics results depend on the resulting 
\series bold
effective
\series default
 dimension, which is equal to the actual input data dimension unless there
 is an 
\emph on
axes
\emph default
 suppression, described above.
 Since the plot has to include a data axis, the plot itself will usually
 have an extra data axis.
\end_layout

\begin_layout Standard
One can plot only three axes directly using standard graphics tools.
 The strategy to deal with the higher effective dimensionality is as follows.
 For simplicity, 
\begin_inset Quotes eld
\end_inset

time
\begin_inset Quotes erd
\end_inset

 is used to label the first effective dimension, although in fact any first
 dimension is possible: 
\end_layout

\begin_layout Description

\emph on
dimensions
\begin_inset space ~
\end_inset

=
\begin_inset space ~
\end_inset

1
\emph default
 For one lattice dimension, a 2D plot of observable
\emph on
 vs t
\emph default
 is plotted, with data at each lattice point in time.
 Exact results, error bars and sampling error bounds are included if available.
 
\end_layout

\begin_layout Description

\emph on
dimensions
\begin_inset space ~
\end_inset

=
\begin_inset space ~
\end_inset

2
\emph default
 For two lattice dimensions, a 3D image of observable
\emph on
 vs x,t
\emph default
 is plotted.
 A movie of distinct 2D graphic plots is also possible.
 Otherwise, a slice through 
\begin_inset Formula $x=0$
\end_inset

 is used tp reduce the lattice dimension to 
\begin_inset Formula $1$
\end_inset

.
 
\end_layout

\begin_layout Description

\emph on
dimensions
\begin_inset space ~
\end_inset

=
\begin_inset space ~
\end_inset

3
\emph default
 For three lattice dimensions, if 
\begin_inset Formula $images>1$
\end_inset

, a movie of distinct 3D graphic images of observables are plotted as 
\begin_inset Formula $images$
\end_inset

 slices versus the first plot dimension.
 Otherwise, a slice through the chosen point, is used at the highest dimension
 to reduce the lattice dimension to 
\begin_inset Formula $2$
\end_inset

.
 
\end_layout

\begin_layout Description

\emph on
dimensions
\begin_inset space ~
\end_inset

=
\begin_inset space ~
\end_inset

4,5..

\emph default
 For higher lattice dimensions, a slice through a chosen point, or the default
 midpoint is used to reduce the lattice dimension to 
\begin_inset Formula $3$
\end_inset

.
 
\end_layout

\begin_layout Standard
As explained above, in addition to graphs versus 
\begin_inset Formula $x_{1}$
\end_inset

 the 
\series bold
xGraph
\series default
 function can generate 
\emph on
images 
\emph default
(3D)
\emph on
 
\emph default
and 
\emph on
transverse
\emph default
 (2D) plots at specified points, up to a maximum given by the number of
 points specified.
 The number of these can be individually specified for each graph number.
 The images available are specified as
\emph on
 imagetype
\emph default

\begin_inset Formula $=1,\ldots4$
\end_inset

, giving: 
\end_layout

\begin_layout Enumerate
3D perspective plots (Matlab 
\emph on
surf
\emph default
 - the default) 
\end_layout

\begin_layout Enumerate
2D filled color plots (Matlab 
\emph on
contourf
\emph default
 ) 
\end_layout

\begin_layout Enumerate
contour plots (Matlab 
\emph on
contour
\emph default
 ) 
\end_layout

\begin_layout Enumerate
pseudo-color plots (Matlab 
\emph on
pcolor
\emph default
 ) 
\end_layout

\begin_layout Standard
Error bars, sampling errors and multiple lines for comparisons are only
 graphed for 2D plots.
 Error-bars are not plotted when they are below a user-specified size, with
 a default of 
\begin_inset Formula $1\%$
\end_inset

 of the maximum range, to improve graphics quality.
 Higher dimensional graphs do not output error-bars, but they are still
 recorded in the data files.
\end_layout

\begin_layout Subsection
Probabilities and parametric plots
\end_layout

\begin_layout Standard
Probability data can be input and plotted like any other data.
 It is typically generated from simulation programs using the 
\begin_inset Formula $binranges$
\end_inset

 data for binning.
 It is plotted like any other graph, with any dimension, except that the
 total dimension is extended by the number of variables or lines in the
 
\emph on
observe
\emph default
 function.
\end_layout

\begin_layout Subsubsection
Chi-squared plots
\end_layout

\begin_layout Standard
In addition the program can make a
\emph on
 
\emph default

\begin_inset Formula $\chi^{2}$
\end_inset

 plot, which is a plot of the 
\begin_inset Formula $\chi^{2}$
\end_inset

 comparison with a comparison probability density against space and/or time.
 This allows a test of the simulated data against a known target probability
 distribution, provided that the following input data conditions are satisfied:
 
\end_layout

\begin_layout Itemize
The input data dimension exceeds the p.
\emph on
dimensions
\emph default
 parameter, 
\end_layout

\begin_layout Itemize
The switch p.
\emph on
chisqplot 
\emph default
is set to 
\begin_inset Formula $1$
\end_inset

or 2, and 
\end_layout

\begin_layout Itemize
The input data includes comparison function data.
 
\end_layout

\begin_layout Standard
The
\emph on
 
\emph default

\begin_inset Formula $\chi^{2}$
\end_inset

 plots, depending on 
\begin_inset Formula $p.chisqplot$
\end_inset

 are: 
\end_layout

\begin_layout Enumerate
a plot of 
\begin_inset Formula $\chi^{2}$
\end_inset

 and 
\begin_inset Formula $k$
\end_inset

, where 
\begin_inset Formula $k$
\end_inset

 is the number of valid data points, 
\end_layout

\begin_layout Enumerate
a plot of 
\begin_inset Formula $\sqrt{2\chi^{2}}$
\end_inset

 and 
\begin_inset Formula $\sqrt{2k-1}$
\end_inset

, which should have a unit variance.
 
\end_layout

\begin_layout Standard
Here, for one point in space and time, with 
\begin_inset Formula $m$
\end_inset

 bins, 
\begin_inset Formula $N_{j}$
\end_inset

 counts per bin and 
\begin_inset Formula $E_{j}$
\end_inset

 expected counts: 
\begin_inset Formula 
\begin{equation}
\chi^{2}=\sum_{j=1}^{m}\frac{\left(N_{j}-E_{j}\right)^{2}}{E_{j}}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The number 
\begin_inset Formula $k$
\end_inset

 is the number of valid counts, with 
\begin_inset Formula $N_{j},E_{j}>mincount$
\end_inset

.
 This is partly determined from the requirement that the probability count
 data per bin is greater than the 
\begin_inset Formula $p.mincount$
\end_inset

 parameter.
 The default is set to give a number of samples 
\begin_inset Formula $>10$
\end_inset

.
 The program prints a summary that sums over of all the 
\begin_inset Formula $\chi^{2}$
\end_inset

 data.
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $p.scale\{n\}$
\end_inset

 parameter gives the number of counts per bin at unit probability density.
 This is needed to set the scale of the 
\begin_inset Formula $\chi^{2}$
\end_inset

 results, ie, 
\begin_inset Formula $N_{j}=scale\{n\}\times p_{j}$
\end_inset

, where 
\begin_inset Formula $p_{j}$
\end_inset

 is the probability density that is compared and plotted in the simulation
 data.
 Note that a uniform bin size is assumed here, to give a uniform scaling.
\end_layout

\begin_layout Subsubsection
Comparisons with variances
\end_layout

\begin_layout Standard
It can be useful to compare two probability distributions with different
 variances.
 For one point in space and time, with 
\begin_inset Formula $m$
\end_inset

 bins, 
\begin_inset Formula $p_{j}$
\end_inset

 probability density and 
\begin_inset Formula $e_{j}$
\end_inset

 expected probability density, 
\begin_inset Formula 
\begin{equation}
\chi^{2}=\sum_{j=1}^{m}\frac{\left(p_{j}-e_{j}\right)^{2}}{\sigma_{j}^{2}+\sigma_{e,j}^{2}}.
\end{equation}

\end_inset

In this case, 
\begin_inset Formula $\sigma_{j}^{2}$
\end_inset

 and 
\begin_inset Formula $\sigma_{e,j}^{2}$
\end_inset

 are the sampling errors in the simulation data and comparison data, so
 that built-in error fields in the data are used to work out the 
\begin_inset Formula $\chi^{2}$
\end_inset

 results.
 This option is chosen if 
\begin_inset Formula $p.scale\{n\}=0$
\end_inset

, and the cutoff for the data is then specified so that 
\begin_inset Formula $p_{j},e_{j}>p.cutoffs\{n\}$
\end_inset

.
 This only has a 
\begin_inset Formula $\chi^{2}$
\end_inset

 distribution if points are independent.
\end_layout

\begin_layout Subsubsection
Maximum likelihood
\end_layout

\begin_layout Standard
It is also possible to plot the 
\begin_inset Formula $G^{2}$
\end_inset

 or maximum likelihood plot of the data, which is an alternative means to
 compare distributions, where 
\begin_inset Formula 
\begin{equation}
G^{2}=2\sum_{j=1}^{m}N_{j}\ln\left(N_{j}/E_{j}\right).
\end{equation}

\end_inset

The expected values 
\begin_inset Formula $E_{j}$
\end_inset

 are automatically scaled so that 
\begin_inset Formula $\sum N_{j}=\sum E_{j},$
\end_inset

with the same minimum count cutoff that is used for the 
\begin_inset Formula $\chi^{2}$
\end_inset

 data.
 The result is similar to the 
\begin_inset Formula $\chi^{2}$
\end_inset

 results.
 It is obtained if p.
\emph on
gsqplot 
\emph default
is set to 
\begin_inset Formula $1$
\end_inset

 or 2 and requires for the input that 
\begin_inset Formula $p.scale\{n\}>0.$
\end_inset

 It is sometimes regarded as a preferred method for comparisons.
\end_layout

\begin_layout Subsubsection
Parametric plots
\end_layout

\begin_layout Standard
Any input dataset can be converted to a parametric plot, where a second
 data input is plotted along the horizontal axis instead of the time coordinate.
 It is also possible to substitute a second data input for the x-axis data
 if a parametric plot in space is required instead.
 This allows visualization of how one type of data changes as a function
 of a second type of data input.
\end_layout

\begin_layout Standard
The two datasets that are plotted must have the same number of lines, that
 is, the first index range should be the same, in order that multiple lines
 can be compared.
 This is achieved where required using the 
\emph on
p.scatters
\emph default
 input in the simulation code.
 The details of the parametric plot are specified using the input: 
\emph on

\begin_inset Formula 
\begin{equation}
p.parametric\{n\}=[n1,p2]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here 
\begin_inset Formula $n$
\end_inset

 is the graph number which is plotted, and must correspond to an input dataset.
 The number 
\begin_inset Formula $n1$
\end_inset

 is the graph number of the observable that is plotted on the horizontal
 axis, ignoring functional transformations.
 The second number is the axis number where the parametric value is substituted,
 which can be the time (axis 1) or the x-coordinate (axis 2), if present.
\end_layout

\begin_layout Standard
In all cases the vertical axis is used to plot the original data.
 The specified horizontal axis is used for the parametric variable.
 Only vertical error-bars are available.
 
\end_layout

\begin_layout Subsection
Parameter reference
\begin_inset CommandInset label
LatexCommand label
name "sec:Parameter-reference"

\end_inset


\end_layout

\begin_layout Subsubsection

\emph on
axes{n}
\end_layout

\begin_layout Description
Default: 
\emph on
{0,0,0,..}
\emph default
 
\end_layout

\begin_layout Standard
Gives the axis points plotted for the 
\begin_inset Formula $n$
\end_inset

-th plotted function, in each dimension.
 Each entry value is a vector range for a particular plot and dimension.
 Thus, 
\emph on
p = 5
\emph default
 gives the fifth point only, and a vector input 
\emph on
p = 1:4:41
\emph default
 plots every fourth point.
 Single points generate graphics projections, allowing the other dimensions
 to be plotted.
 Zero or negative values are shorthand.
 For example, 
\emph on
p = -1
\emph default
 generates a default point at the midpoint, 
\emph on
p = -2
\emph default
 the endpoint, and 
\emph on
p = 0
\emph default
 is the default value that gives the vector for the every axis point.
 For each graph type, i.e.
 
\emph on
n=1,..graphs
\emph default
 the axes can be individually specified in each dimension, 
\emph on
d=1,..dimension
\emph default
s.
 If more than three axes are specified to be vectors, only the first three
 are used, and others are set to default values in the plots.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.axes{4} = {1:2:10,0,0,-1}
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
diffplot{n}
\end_layout

\begin_layout Description
Default: 
\emph on
0
\emph default
 
\end_layout

\begin_layout Standard
Differences are plotted as a comparison dashed line on 
\begin_inset Formula $2D$
\end_inset

 plots as a default.
 Otherwise, a separate difference plot is obtained which is unnormalized
 (
\emph on
diffplot = 1)
\emph default
, or normalized
\emph on
 
\emph default
(
\emph on
diffplot = 2) 
\emph default
by the total RMS errors.
 If 
\emph on
diffplot = 3
\emph default
, the comparison data is plotted directly as an additional graph.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.diffplot{3} = 2
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
errors
\end_layout

\begin_layout Description
Default: 
\emph on
0
\emph default
 
\end_layout

\begin_layout Standard
Indicates if the last index in the graphics input data arrays is used for
 error-bars and/or comparisons.
 Should be set to zero if there is no error or comparison data.
 If non-zero, this will give the highest last index used for errors.
 The standard 
\emph on
xsim
\emph default
 output sets 
\emph on

\begin_inset Formula $p.errors=3$
\end_inset

 
\emph default
automatically.
 As a special case, 
\emph on

\begin_inset Formula $p.errors=1$
\end_inset

 
\emph default
is used to indicate that there is comparison data but no error data.
\end_layout

\begin_layout Standard
If 
\emph on

\begin_inset Formula $p.errors>0$
\end_inset

 
\emph default
, the data indexed up to 
\emph on
p.errors
\emph default
 gives the data, then a maximum of two types of error bars.
 Up to three further index values, up to 
\emph on

\begin_inset Formula $p.errors+3$
\end_inset

,
\emph default
 are available to index all comparison data and its error fields.
 The maximum last index value used is 
\begin_inset Formula $6$
\end_inset

.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.errors = 2
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
esample{n}
\end_layout

\begin_layout Description
Default: 
\emph on
1
\emph default
 
\end_layout

\begin_layout Standard
This sets the type and size of sampling errors that are plotted.
 If 
\emph on
esample = 0
\emph default
, no sampling error lines are plotted, just the mean.
 If 
\begin_inset Formula $esample=-n$
\end_inset

, 
\begin_inset Formula $\pm n\sigma$
\end_inset

 sampling errors are included in the error-bars.
 If 
\begin_inset Formula $esample=n$
\end_inset

, separate upper and lower 
\begin_inset Formula $\pm n\sigma$
\end_inset

 sampling error lines are plotted.
 In both cases, the magnitude of esample sets the number of standard deviations
 used.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.esample{3} = -1
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
font{n}
\end_layout

\begin_layout Description
Default: 
\emph on
18
\emph default
 
\end_layout

\begin_layout Standard
This sets the default font sizes for the graph labels, indexed by graph.
 This can be changed per graph.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.font{4}=18
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
functions
\end_layout

\begin_layout Description
Default: number of functional transformations 
\end_layout

\begin_layout Standard
This gives the maximum number of output graph functions and is available
 to restrict graphical output.
 The default is the length of the cell array of input data.
 Normally, the default will be used.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.functions = 10
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
glabels{n}
\end_layout

\begin_layout Description
Default: 
\emph on
xlabels
\emph default
 or 
\emph on
klabels
\emph default
 
\end_layout

\begin_layout Standard
Graph-dependent labels for the independent variable labels.
 This is a nested cell array with first dimension of 
\emph on
graphs
\emph default
 and second dimension of 
\emph on
dimension
\emph default
s.
 This is used to replace the global values of 
\emph on
xlabels
\emph default
 or 
\emph on
klabels
\emph default
 if the axis labels change from graph to graph, for example, if the coordinates
 have a functional transform.
 These can be set for an individual coordinate on one graph if needed.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.glabels{4}{2} = 'x^2'
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
graphs
\end_layout

\begin_layout Description
Default: observables to plot 
\end_layout

\begin_layout Standard
This gives the observables to plot.
 The default is a vector of indices from one to the length of the cell array
 of observe functions.
 Normally not initialized, as the default is used.
 Mostly used to reduce graphical output on a long file.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.graphs = 10
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
gtransforms{n}
\end_layout

\begin_layout Description
Default: [0,0,...] 
\end_layout

\begin_layout Standard
This switch specifies the Fourier transformed graphs and axes for graphics
 labeling.
 Automatically equal to 
\emph on
ftransforms
\emph default
 if from an earlier xSIM input, but can be changed.
 If altered for a given graph, all the axis Fourier switches should be reset.
 This is ignored if there is no 
\emph on
dimensions
\emph default
 setting to indicate space dimensions.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.gtransforms{1} = [0,0,1]
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
headers{n}
\end_layout

\begin_layout Description
Default: 
\emph on

\begin_inset Quotes erd
\end_inset


\emph default
 
\end_layout

\begin_layout Standard
This is a string variable giving the graph headers for each type of function
 plotted.
 The default value is an empty string.
 Otherwise, the header string that is input is used.
 Either is combined with the simulation name and a graph number to identify
 the graph.
 This is used to include simulation headers to identify graphs in simulation
 outputs.
 Graph headers may not be needed in a final published result.
 For this, either edit the graph, or use a space to make plot headers blank:
\emph on
 p.headers{n} = ' '
\emph default
, or 
\emph on
p.name = ' '
\emph default
 .
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.headers{n} = 'my_graph_header'
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
images{n}
\end_layout

\begin_layout Description
Default: 
\emph on
0
\emph default
 
\end_layout

\begin_layout Standard
This is the number of 3D, transverse o-x-y images plotted as discrete time
 slices.
 Only valid if the input data dimension is greater than 2.
 If present, the coordinates not plotted are set to their central value
 when plotting the transverse images.
 This input should have a value from zero up to a maximum value of the number
 of plotted points.
 It has a vector length equal to 
\emph on
graphs.

\emph default
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.images{4} = 5
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
imagetype{n}
\end_layout

\begin_layout Description
Default: 
\emph on
1
\emph default
 
\end_layout

\begin_layout Standard
This is the type of transverse o-x-y movie images plotted.
 It has a vector length equal to 
\emph on
graphs
\emph default
.
 
\end_layout

\begin_layout Itemize

\emph on
imagetype =
\emph default
 
\emph on
1 
\emph default
gives a perspective surface plot 
\end_layout

\begin_layout Itemize

\emph on
imagetype =
\emph default
 
\emph on
2
\emph default
, gives a 2D plot with colors 
\end_layout

\begin_layout Itemize

\emph on
imagetype =
\emph default
 3 gives a contour plot with 10 equally spaced contours 
\end_layout

\begin_layout Itemize

\emph on
imagetype =
\emph default
 4 gives a pseudo-color map 
\end_layout

\begin_layout Description
Example: 
\emph on
p.imagetype{n} = 1, 2, 3, 4
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
klabels
\end_layout

\begin_layout Description
Default: 
\emph on
{'
\backslash
omega', 'k_x', 'k_y', 'k_z'}
\begin_inset Quotes eld
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

{'k_1', 'k_2', 'k_3', 'k_4',...}
\emph default
 
\end_layout

\begin_layout Standard
Labels for the graph axis Fourier transform labels, vector length of 
\emph on
dimension
\emph default
s.
 The numerical labeling default is used when the 
\begin_inset Quotes eld
\end_inset


\emph on
p.numberaxis
\emph default

\begin_inset Quotes eld
\end_inset

 option is set.
 Note, these are typeset in Latex mathematics mode! When changing from the
 default values, all the required new labels must be set.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.klabels= {'
\backslash
Omega', 'K_x', 'K_y',}
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
legends{n}
\end_layout

\begin_layout Description
Default: 
\emph on
{
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

}
\emph default
 
\end_layout

\begin_layout Standard
Graph-dependent legends, specified as a nested cell array of strings for
 each line.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.legends{n} = {labels(1), ..., labels(lines)}
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
limits{n}
\end_layout

\begin_layout Description
Default: 
\emph on
{0,0,0,0; ...}
\emph default
 
\end_layout

\begin_layout Standard
Graph-dependent limits specified as a cell array with dimension 
\emph on
graphs
\emph default
.
 Each entry is a cell array of graph limits indexed by the dimension, starting
 from 
\begin_inset Formula $d=1$
\end_inset

 for the time dimension.
 The limits are vectors, indexed as 1,2 for the lower and upper plot limits.
 This is useful if the limits required change from graph to graph.
 If an automatic limit is required for either the upper or lower limit,
 it is set to 
\emph on
inf.
 
\end_layout

\begin_layout Standard
An invalid, scalar or empty limit vector, like [0,0] or 
\begin_inset Formula $0$
\end_inset

 or [] is ignored, and an automatic graph limit is used.
\end_layout

\begin_layout Description
Example: 
\emph on
p.limits{n} = {[t1,t2],[x1,x2],[y1,y2] ...,}
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
linestyle{n}
\end_layout

\begin_layout Description
Default: 
\emph on
{'-k','--k',':k','-.k','-ok','-
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset

-ok',':ok','-.ok','-+k','-
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{}
\end_layout

\end_inset

-+k'}
\emph default
 
\end_layout

\begin_layout Standard
Line types for each line in every two-dimensional graph plotted.
 If a given line on a two-dimensional line is to be removed completely,
 set the relevant line-style to zero.
 For example, to remove the first line from graph 3, set p.linestyle{3} ={0}.
 This is useful when generating and changing graphics output from a saved
 data file.
 The linestyle uses Matlab terminology.
 It allows setting the line pattern, marker symbols and color for every
 line.
 The default lines are black (
\emph on
'k'
\emph default
), but any other color can be used instead.
 
\end_layout

\begin_layout Standard
The specifiers must be chosen from the list below, eg, '-ok', although the
 marker can be omitted if not required.
\end_layout

\begin_layout Itemize
Line patterns: '-' (solid), '–' (dashed), ':' (dotted) ,'-.' (dash-dot)
\end_layout

\begin_layout Itemize
Marker symbols: '+','o','*','.','x','s','d','^','v','>','<','p'
\end_layout

\begin_layout Itemize
Colors: 'r','g','b','c','m','y','k','w'
\end_layout

\begin_layout Description
Example: 
\emph on
p.linestyle{4} = {'-k','--ok',':g','-.b',}
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
linewidth{n}
\end_layout

\begin_layout Description
Default: 0.5
\end_layout

\begin_layout Standard
Line width for plotted lines in two-dimensional graphs.
 For example, to make the lines wider in graph 3, set p.linewidth{3} =1.
 This is useful for changing graphics output appearance if the default lines
 are too thin.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.linewidth{n} = 1
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
minbar{n}
\end_layout

\begin_layout Description
Default: 
\emph on
{0.01, ...}
\emph default
 
\end_layout

\begin_layout Standard
This is the minimum relative error-bar that is plotted.
 Set to a large value to suppress unwanted error-bars, although its best
 not to ignore the error-bar information! This can be changed per graph.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.minbar{n} = 0
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
name
\end_layout

\begin_layout Description
Default: 
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_layout Standard
Name used to label simulation graphs, usually corresponding to the equation
 or problem solved.
 This can be removed from individual graphs by using 
\emph on
headers{n}
\emph default
 equal to a single blank space.
 The default is a null string.
 To remove all headers globally, set 
\emph on
name
\emph default
 equal to a single blank space: 
\emph on
name = ' '.

\emph default
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.name = 'Wiener process simulation'
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
olabels{n}
\end_layout

\begin_layout Description
Default: 
\emph on
'a'
\emph default
 
\end_layout

\begin_layout Standard
Cell array of labels for the graph axis observables and functions.
 These are text labels that are used on the graph axes.
 The default value is 
\emph on
'a_1
\emph default
' if the default observable is used, otherwise it is blank.
 This is overwritten by any subsequent label input when the graphics program
 is run: 
\end_layout

\begin_layout Description
Example: 
\emph on
p.olabels{4} = 'v'
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
parametric{n}
\end_layout

\begin_layout Description
Default: 
\emph on
[0,0]
\emph default
 
\end_layout

\begin_layout Standard
Cell array that defines parametric plots, for each graph number.
 The first number is the graph number of the alternative observable plotted
 on the horizontal axis.
 The second number is the axis number where the parametric value is substituted,
 which can be the time (axis 1) or the x-coordinate (axis 2), if present.
\end_layout

\begin_layout Standard
If both are zero, the plot against an independent space-time coordinate
 is calculated as usual.
 If nonzero, a parametric plot is made for two-dimensional plots.
 In all cases the vertical axis is used to plot the original data.
 The specified horizontal axis is used for the parametric variable.
 Only vertical error-bars are available.
 Can be usefully combined with 
\emph on
scatters{n}
\emph default
 to plot individual trajectories, but the number of scatters should be the
 same in each of the two graphs that are parametrically plotted against
 each other.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.parametric{n} = [p1,p2] 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
textgreater
\end_layout

\end_inset

 = 0
\emph default
 
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "subsec:pdimension"

\end_inset


\emph on
pdimension{n}
\end_layout

\begin_layout Description
Default: 
\emph on
3
\emph default
 
\end_layout

\begin_layout Standard
This is the maximum plotted space-time dimension for each plotted quantity.
 The purpose is eliminate unwanted graphs.
 For example, it is useful to reduce the maximum dimension when averaging
 in space.
 Higher dimensional graphs are not needed, as the data is duplicated.
 Averaging can be useful for checking conservation laws, or for averaging
 over homogeneous data to reduce sampling errors.
 All graphs are suppressed if it is set to zero.
 Any three dimensions can be chosen to be plotted, using the 
\emph on
axes
\emph default
 parameter to suppress the unwanted data points in other dimensions.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.pdimension{4} = 2
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
saveeps
\end_layout

\begin_layout Description
Default: 0 
\end_layout

\begin_layout Standard
If set to 
\begin_inset Formula $1$
\end_inset

, all plots are saved to the current folder as .eps files, numbered consecutively.
 It is best to use the 
\emph on
close all
\emph default
 command first to remove unwanted displayed xFIGURES, before running 
\emph on
xGraph
\emph default
 with this option.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.saveeps =1
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
savefig
\end_layout

\begin_layout Description
Default: 0 
\end_layout

\begin_layout Standard
If set to 
\begin_inset Formula $1$
\end_inset

, all plots are saved to the current folder as .fig files, numbered consecutively.
 It is best to use the 
\emph on
close all
\emph default
 command first to remove unwanted displayed xFIGURES, before running 
\emph on
xGraph
\emph default
 with this option.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.savefig =1
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
transverse{n}
\end_layout

\begin_layout Description
Default: 
\emph on
0
\emph default
 
\end_layout

\begin_layout Standard
This is the number of 2D transverse images plotted as discrete time slices.
 Only valid if 
\emph on
dimensions
\emph default
 is greater than 2.
 If present, the 
\begin_inset Formula $y,z$
\end_inset

-coordinates are set to their central values when plotting transverse images.
 Each element can be from 0 up to the number of plotted time-points.
 The cell array has a vector length equal to 
\emph on
graphs
\emph default
.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.transverse{n}= 6
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
verbose
\end_layout

\begin_layout Description
Default: 0 
\end_layout

\begin_layout Standard
Print flag for output information while running xGraph.
 Print options are: 
\end_layout

\begin_layout Itemize
Minimal if 
\emph on
verbose = -1
\emph default
: Prints just the start-up time and hard error messages 
\end_layout

\begin_layout Itemize
Brief if 
\emph on
verbose = 0
\emph default
: Additionally prints the final, total chi-squared errors where present
 
\end_layout

\begin_layout Itemize
Informative if 
\emph on
verbose = 1
\emph default
: Also prints the graph progress indicators 
\end_layout

\begin_layout Itemize
Full if 
\emph on
verbose = 2
\emph default
: Prints everything including the internal parameter structure data.
 
\end_layout

\begin_layout Standard
In summary, if 
\emph on
verbose = 0
\emph default
, most output is suppressed except the final data, 
\emph on
verbose = 1
\emph default
 displays a progress report, and 
\emph on
verbose = 2
\emph default
 additionally generates a readable summary of the graphics parameter input.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.verbose = 0
\emph default
 
\end_layout

\begin_layout Subsubsection

\emph on
xlabels
\end_layout

\begin_layout Description
Default: 
\emph on
{'t', 'x', 'y', 'z'}
\emph default
 or {
\emph on
'x_1', 'x_2', 'x_3', 'x_4'
\emph default
,...} 
\end_layout

\begin_layout Standard
Global labels for the independent variable labels, vector length equal to
 
\emph on
dimension
\emph default
s.
 The numerical labeling default is used when the 
\emph on
numberaxis
\emph default
 option is true.
 These are typeset in Latex mathematics mode.
 When changing from the default values, all the required new labels must
 be set.
 
\end_layout

\begin_layout Description
Example: 
\emph on
p.xlabels = {'tau'}
\emph default
 
\end_layout

\begin_layout Subsection
User function reference
\end_layout

\begin_layout Standard
It is possible to simply run 
\emph on
xGraph
\emph default
 as is, without much intervention.
 However, there are customization options, including user defined functions.
 These are as follows:
\end_layout

\begin_layout Subsubsection

\emph on
gfunction{n} (d,p)
\end_layout

\begin_layout Standard
This is a cell array of graphics function handles.
 Use when a graph is needed that is a functional transformation of the observed
 averages.
 The default value generates the 
\emph on
n-th 
\emph default
graph 
\emph on
data
\emph default
 array directly from the 
\emph on
n-th 
\emph default
input 
\emph on
data
\emph default
.
 The input is the data cell array for all the graphs in the current sequence
 number with their graph parameters 
\emph on
x
\emph default
, and the output is the 
\emph on
n-th 
\emph default
data array that is plotted.
\end_layout

\begin_layout Standard
An arbitrary number of functions of these observables can be plotted, including
 vector observables.
 The input to graphics functions is the observed data averages or functions
 of averages in a given sequence, each stored in a cell array 
\begin_inset Formula $d\{n\}(\ell,\mathbf{j},c)$
\end_inset

.
 If there are more graphics functions than input data cells, this generate
 additional data for plotting.
\end_layout

\begin_layout Subsubsection

\emph on
xfunctions{n} {nd} (ax,p)
\end_layout

\begin_layout Standard
This is a nested cell array of axis transformations.
 Use when a graph is needed with an axis that is a function of the original
 axes.
 The input is the original axis coordinates, and the output is the new coordinat
e set.
 The default value generates the input axes.
 Called as 
\emph on
xfunctions{n}{nd}(ax,p)
\emph default
 for the 
\emph on
n
\emph default
-th graph and axis direction 
\emph on
dir
\emph default
, where 
\emph on
ax
\emph default
 is a vector of coordinates for that axis.There is one graphics function
 for each separate graph dimension or axis.
 The default value is the coordinate vector 
\begin_inset Formula $xk\{nd\}$
\end_inset

 stored in the input parameter structure p, or else the relevant index if
 
\emph on
xk{nd}
\emph default
 is omitted.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "xQSIM"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
